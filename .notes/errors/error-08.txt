
[7m438[0m       const dailyPattern = await this.identifyDailyPattern(seasonalComponents)
[7m   [0m [91m                                      ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m393[0m:[93m23[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'network'.

[7m393[0m         networkGraph: network,
[7m   [0m [91m                      ~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m385[0m:[93m48[0m - [91merror[0m[90m ts(2339): [0mProperty 'generateContainmentStrategies' does not exist on type 'AdvancedPredictiveThreatIntelligence'.

[7m385[0m       const containmentStrategies = await this.generateContainmentStrategies(
[7m   [0m [91m                                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m382[0m:[93m20[0m - [91merror[0m[90m ts(2339): [0mProperty 'calculateTimeToPropagation' does not exist on type 'AdvancedPredictiveThreatIntelligence'.

[7m382[0m         await this.calculateTimeToPropagation(simulation)
[7m   [0m [91m                   ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m378[0m:[93m40[0m - [91merror[0m[90m ts(2339): [0mProperty 'identifyAffectedNodes' does not exist on type 'AdvancedPredictiveThreatIntelligence'.

[7m378[0m       const affectedNodes = await this.identifyAffectedNodes(simulation)
[7m   [0m [91m                                       ~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m371[0m:[93m37[0m - [91merror[0m[90m ts(2551): [0mProperty 'simulateThreatPropagation' does not exist on type 'AdvancedPredictiveThreatIntelligence'. Did you mean 'modelThreatPropagation'?

[7m371[0m       const simulation = await this.simulateThreatPropagation(
[7m   [0m [91m                                    ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m360[0m:[93m9[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'network'.

[7m360[0m         network,
[7m   [0m [91m        ~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m351[0m:[93m30[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'network'.

[7m351[0m       if (!initialThreat || !network) {
[7m   [0m [91m                             ~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m329[0m:[93m20[0m - [91merror[0m[90m ts(2339): [0mProperty 'generateNovelThreatRecommendations' does not exist on type 'AdvancedPredictiveThreatIntelligence'.

[7m329[0m         await this.generateNovelThreatRecommendations(significantNovelThreats)
[7m   [0m [91m                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m306[0m:[93m20[0m - [91merror[0m[90m ts(2339): [0mProperty 'extractThreatFeatures' does not exist on type 'AdvancedPredictiveThreatIntelligence'.

[7m306[0m         await this.extractThreatFeatures(processedBaseline)
[7m   [0m [91m                   ~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m304[0m:[93m42[0m - [91merror[0m[90m ts(2339): [0mProperty 'extractThreatFeatures' does not exist on type 'AdvancedPredictiveThreatIntelligence'.

[7m304[0m       const currentFeatures = await this.extractThreatFeatures(processedCurrent)
[7m   [0m [91m                                         ~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m266[0m:[93m9[0m - [91merror[0m[90m ts(18004): [0mNo value exists in scope for the shorthand property 'timeframe'. Either declare one or provide an initializer.

[7m266[0m         timeframe,
[7m   [0m [91m        ~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m259[0m:[93m43[0m - [91merror[0m[90m ts(2339): [0mProperty 'evaluateModelPerformance' does not exist on type 'AdvancedPredictiveThreatIntelligence'.

[7m259[0m       const modelPerformance = await this.evaluateModelPerformance(
[7m   [0m [91m                                          ~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m252[0m:[93m40[0m - [91merror[0m[90m ts(2339): [0mProperty 'analyzeTrends' does not exist on type 'AdvancedPredictiveThreatIntelligence'.

[7m252[0m       const trendAnalysis = await this.analyzeTrends(timeSeries, predictions)
[7m   [0m [91m                                       ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m245[0m:[93m66[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'timeframe'.

[7m245[0m       const predictions = await this.generatePredictions(models, timeframe)
[7m   [0m [91m                                                                 ~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m210[0m:[93m30[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ThreatModelRegistry'.

[7m210[0m     this.modelRegistry = new ThreatModelRegistry(this.mongoClient)
[7m   [0m [91m                             ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m196[0m:[93m34[0m - [91merror[0m[90m ts(2741): [0mProperty 'detectNovelThreats' is missing in type 'typeof MLNoveltyDetector' but required in type 'NoveltyDetector'.

[7m196[0m     this.noveltyDetector = class MLNoveltyDetector {
[7m   [0m [91m                                 ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m173[0m:[93m26[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ModelRegistry'.

[7m173[0m   private modelRegistry: ModelRegistry
[7m   [0m [91m                         ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m172[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'riskAssessor' has no initializer and is not definitely assigned in the constructor.

[7m172[0m   private riskAssessor: RiskAssessor
[7m   [0m [91m          ~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m171[0m:[93m3[0m - [91merror[0m[90m ts(2564): [0mProperty 'seasonalAnalyzer' has no initializer and is not definitely assigned in the constructor.

[7m171[0m   seasonalAnalyzer: SeasonalAnalyzer
[7m   [0m [91m  ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m170[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'propagationModeler' has no initializer and is not definitely assigned in the constructor.

[7m170[0m   private propagationModeler: PropagationModeler
[7m   [0m [91m          ~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m169[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'noveltyDetector' has no initializer and is not definitely assigned in the constructor.

[7m169[0m   private noveltyDetector: NoveltyDetector
[7m   [0m [91m          ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m168[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'timeSeriesForecaster' has no initializer and is not definitely assigned in the constructor.

[7m168[0m   private timeSeriesForecaster: TimeSeriesForecaster
[7m   [0m [91m          ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m167[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m167[0m   private mongoClient: MongoClient
[7m   [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m166[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m166[0m   private redis: Redis
[7m   [0m [91m          ~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m162[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'AdvancedPredictiveThreatIntelligence'.

[7m162[0m export class AdvancedPredictiveThreatIntelligence
[7m   [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m133[0m:[93m16[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'TimeSeriesPrediction'.

[7m133[0m   predictions: TimeSeriesPrediction[]
[7m   [0m [91m               ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m96[0m:[93m20[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ThreatCharacteristics'.

[7m96[0m   characteristics: ThreatCharacteristics
[7m  [0m [91m                   ~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m78[0m:[93m21[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ModelPerformanceMetrics'.

[7m78[0m   modelPerformance: ModelPerformanceMetrics
[7m  [0m [91m                    ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m1479[0m:[93m23[0m - [93mwarning[0m[90m ts(6138): [0mProperty 'config' is declared but its value is never read.

[7m1479[0m   constructor(private config: PropagationConfig) {
[7m    [0m [93m                      ~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m1454[0m:[93m23[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m1454[0m         const value = await tf.tidy(async () => {
[7m    [0m [93m                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1455[0m           const prediction = model.predict(dummyInput) as tf.Tensor
[7m    [0m [93m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1457[0m           return data[0] as number
[7m    [0m [93m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1458[0m         })
[7m    [0m [93m~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m1312[0m:[93m28[0m - [93mwarning[0m[90m ts(80006): [0mThis may be converted to an async function.

[7m1312[0m       return await tf.tidy(() => {
[7m    [0m [93m                           ~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m1312[0m:[93m14[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m1312[0m       return await tf.tidy(() => {
[7m    [0m [93m             ~~~~~~~~~~~~~~~~~~~~~[0m
[7m1313[0m         // Create LSTM model architecture
[7m    [0m [93m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1376[0m         })
[7m    [0m [93m~~~~~~~~~~[0m
[7m1377[0m       })
[7m    [0m [93m~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m888[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'context' is declared but its value is never read.

[7m888[0m     context: SecurityContext,
[7m   [0m [93m    ~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m887[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'threats' is declared but its value is never read.

[7m887[0m     threats: Threat[],
[7m   [0m [93m    ~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m820[0m:[93m33[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'edge' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m820[0m       edges: network.edges.map((edge) => ({
[7m   [0m [93m                                ~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m811[0m:[93m33[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'node' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m811[0m       nodes: network.nodes.map((node) => ({
[7m   [0m [93m                                ~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m777[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'currentFeatures' is declared but its value is never read.

[7m777[0m     currentFeatures: ThreatFeatures,
[7m   [0m [93m    ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m700[0m:[93m34[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'threat' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m700[0m         dataPoints: threats.map((threat) => ({
[7m   [0m [93m                                 ~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m679[0m:[93m11[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'b' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m679[0m       (a, b) => a.timestamp.getTime() - b.timestamp.getTime(),
[7m   [0m [93m          ~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m679[0m:[93m8[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'a' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m679[0m       (a, b) => a.timestamp.getTime() - b.timestamp.getTime(),
[7m   [0m [93m       ~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m480[0m:[93m17[0m - [93mwarning[0m[90m ts(6133): [0m'extractSeasonalPatternsFromComponents' is declared but its value is never read.

[7m480[0m   private async extractSeasonalPatternsFromComponents(
[7m   [0m [93m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m173[0m:[93m11[0m - [93mwarning[0m[90m ts(6133): [0m'modelRegistry' is declared but its value is never read.

[7m173[0m   private modelRegistry: ModelRegistry
[7m   [0m [93m          ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m172[0m:[93m11[0m - [93mwarning[0m[90m ts(6133): [0m'riskAssessor' is declared but its value is never read.

[7m172[0m   private riskAssessor: RiskAssessor
[7m   [0m [93m          ~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m170[0m:[93m11[0m - [93mwarning[0m[90m ts(6133): [0m'propagationModeler' is declared but its value is never read.

[7m170[0m   private propagationModeler: PropagationModeler
[7m   [0m [93m          ~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m21[0m:[93m63[0m - [93mwarning[0m[90m ts(6385): [0m'(from: number, length?: number | undefined): string' is deprecated.

[7m21[0m   return `${prefix}${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
[7m  [0m [93m                                                              ~~~~~~[0m
[96msrc/lib/threat-detection/predictive/predictive-threat-intelligence.ts[0m:[93m3[0m:[93m10[0m - [93mwarning[0m[90m ts(6133): [0m'_secureId' is declared but its value is never read.

[7m3[0m function _secureId(prefix = ''): string {
[7m [0m [93m         ~~~~~~~~~[0m

[96msrc/lib/threat-detection/threat-hunting/investigation-utils.ts[0m:[93m6[0m:[93m71[0m - [91merror[0m[90m ts(2307): [0mCannot find module './types' or its corresponding type declarations.

[7m6[0m import type { ThreatHunt, InvestigationResult, ThreatIndicator } from './types'
[7m [0m [91m                                                                      ~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/investigation-utils.ts[0m:[93m275[0m:[93m34[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'indicator' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m275[0m       result.indicators.forEach((indicator) => {
[7m   [0m [93m                                 ~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/investigation-utils.ts[0m:[93m229[0m:[93m36[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'indicator' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m229[0m     return result.indicators.some((indicator) => {
[7m   [0m [93m                                   ~~~~~~~~~[0m

[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1440[0m:[93m3[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'InvestigationFinding'.

[7m1440[0m   InvestigationFinding,
[7m    [0m [91m  ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1439[0m:[93m3[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'Investigation'.

[7m1439[0m   Investigation,
[7m    [0m [91m  ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1438[0m:[93m3[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'HuntFinding'.

[7m1438[0m   HuntFinding,
[7m    [0m [91m  ~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1437[0m:[93m3[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'HuntResult'.

[7m1437[0m   HuntResult,
[7m    [0m [91m  ~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1436[0m:[93m3[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'InvestigationTemplate'.

[7m1436[0m   InvestigationTemplate,
[7m    [0m [91m  ~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1435[0m:[93m3[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'HuntingRule'.

[7m1435[0m   HuntingRule,
[7m    [0m [91m  ~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1434[0m:[93m3[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'ThreatHuntingConfig'.

[7m1434[0m   ThreatHuntingConfig,
[7m    [0m [91m  ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1349[0m:[93m22[0m - [91merror[0m[90m ts(2352): [0mConversion of type 'WithId<Document>[]' to type 'HuntResult[]' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Type 'WithId<Document>' is missing the following properties from type 'HuntResult': huntId, ruleId, timestamp, findings, and 4 more.

[7m1349[0m         recentHunts: recentHunts as HuntResult[],
[7m    [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1272[0m:[93m14[0m - [91merror[0m[90m ts(2352): [0mConversion of type 'WithId<Document>[]' to type 'Investigation[]' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Type 'WithId<Document>' is missing the following properties from type 'Investigation': investigationId, status, priority, steps, and 3 more.

[7m1272[0m       return investigations as Investigation[]
[7m    [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1191[0m:[93m11[0m - [91merror[0m[90m ts(2367): [0mThis comparison appears to be unintentional because the types '"evidence" | "anomaly" | "indicator" | "conclusion"' and '"iocs"' have no overlap.

[7m1191[0m       if (finding.type === 'iocs') {
[7m    [0m [91m          ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m847[0m:[93m24[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m847[0m           step.error = error.message
[7m   [0m [91m                       ~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m822[0m:[93m13[0m - [91merror[0m[90m ts(2367): [0mThis comparison appears to be unintentional because the types '"running"' and '"cancelled"' have no overlap.

[7m822[0m         if (investigation.status === 'cancelled') {
[7m   [0m [91m            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m622[0m:[93m31[0m - [91merror[0m[90m ts(2339): [0mProperty 'indexOf' does not exist on type 'TensorContainer'.
  Property 'indexOf' does not exist on type 'number'.

[7m622[0m       const maxIndex = result.indexOf(Math.max(...result))
[7m   [0m [91m                              ~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m615[0m:[93m35[0m - [91merror[0m[90m ts(2531): [0mObject is possibly 'null'.

[7m615[0m         const prediction = (await this.huntingModel.predict(
[7m   [0m [91m                                  ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m613[0m:[93m36[0m - [91merror[0m[90m ts(2345): [0mArgument of type '() => Promise<number[]>' is not assignable to parameter of type 'string | ScopeFn<TensorContainer>'.
  Type '() => Promise<number[]>' is not assignable to type 'ScopeFn<TensorContainer>'.

[7m613[0m       const result = await tf.tidy(async () => {
[7m   [0m [91m                                   ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m254[0m:[93m15[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'ruleId' does not exist in type '{ huntId?: string | undefined; threatId?: string | undefined; templateId?: string | undefined; priority?: number | undefined; }'.

[7m254[0m               ruleId: rule.ruleId,
[7m   [0m [91m              ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m127[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m127[0m   private mongoClient: MongoClient
[7m   [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m126[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m126[0m   private redis: Redis
[7m   [0m [91m          ~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m1127[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'parameters' is declared but its value is never read.

[7m1127[0m     parameters: Record<string, unknown>,
[7m    [0m [93m    ~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m615[0m:[93m29[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m615[0m         const prediction = (await this.huntingModel.predict(
[7m   [0m [93m                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m616[0m           inputTensor,
[7m   [0m [93m~~~~~~~~~~~~~~~~~~~~~~[0m
[7m617[0m         )) as tf.Tensor
[7m   [0m [93m~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/threat-hunting-service.ts[0m:[93m613[0m:[93m22[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m613[0m       const result = await tf.tidy(async () => {
[7m   [0m [93m                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m614[0m         const inputTensor = tf.tensor2d([features])
[7m   [0m [93m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m...[0m 
[7m619[0m         return Array.from(data) as number[]
[7m   [0m [93m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m620[0m       })
[7m   [0m [93m~~~~~~~~[0m

[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1326[0m:[93m35[0m - [91merror[0m[90m ts(2339): [0mProperty 'findings' does not exist on type 'void'.

[7m1326[0m       expect(updatedInvestigation.findings[0].type).toBe('apt_tactics')
[7m    [0m [91m                                  ~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1325[0m:[93m35[0m - [91merror[0m[90m ts(2339): [0mProperty 'findings' does not exist on type 'void'.

[7m1325[0m       expect(updatedInvestigation.findings).toHaveLength(1)
[7m    [0m [91m                                  ~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1324[0m:[93m35[0m - [91merror[0m[90m ts(2339): [0mProperty 'progress' does not exist on type 'void'.

[7m1324[0m       expect(updatedInvestigation.progress).toBe(75)
[7m    [0m [91m                                  ~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1320[0m:[93m9[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 2.

[7m1320[0m         updateData,
[7m    [0m [91m        ~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1318[0m:[93m50[0m - [91merror[0m[90m ts(2341): [0mProperty 'updateInvestigation' is private and only accessible within class 'ThreatHuntingService'.

[7m1318[0m       const updatedInvestigation = await service.updateInvestigation(
[7m    [0m [91m                                                 ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1310[0m:[93m45[0m - [91merror[0m[90m ts(2339): [0mProperty 'analyzePatterns' does not exist on type 'ThreatHuntingService'.

[7m1310[0m       const patternAnalysis = await service.analyzePatterns(huntResults)
[7m    [0m [91m                                            ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1298[0m:[93m41[0m - [91merror[0m[90m ts(2341): [0mProperty 'executeHuntQuery' is private and only accessible within class 'ThreatHuntingService'.

[7m1298[0m       const huntResults = await service.executeHuntQuery(huntQuery.id)
[7m    [0m [91m                                        ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1288[0m:[93m39[0m - [91merror[0m[90m ts(2339): [0mProperty 'createHuntQuery' does not exist on type 'ThreatHuntingService'.

[7m1288[0m       const huntQuery = await service.createHuntQuery(queryData)
[7m    [0m [91m                                      ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1278[0m:[93m43[0m - [91merror[0m[90m ts(2551): [0mProperty 'createInvestigation' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m1278[0m       const investigation = await service.createInvestigation(investigationData)
[7m    [0m [91m                                          ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1261[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'analyzeTimeline' does not exist on type 'ThreatHuntingService'.

[7m1261[0m       const analysis = await service.analyzeTimeline(timeline.id)
[7m    [0m [91m                                     ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1248[0m:[93m23[0m - [91merror[0m[90m ts(2339): [0mProperty 'addTimelineEvent' does not exist on type 'ThreatHuntingService'.

[7m1248[0m         await service.addTimelineEvent(timeline.id, event)
[7m    [0m [91m                      ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1233[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'createTimeline' does not exist on type 'ThreatHuntingService'.

[7m1233[0m       const timeline = await service.createTimeline('inv_1', timelineData)
[7m    [0m [91m                                     ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1218[0m:[93m39[0m - [91merror[0m[90m ts(2339): [0mProperty 'createHuntQuery' does not exist on type 'ThreatHuntingService'.

[7m1218[0m       const huntQuery = await service.createHuntQuery(queryData)
[7m    [0m [91m                                      ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1209[0m:[93m43[0m - [91merror[0m[90m ts(2551): [0mProperty 'createInvestigation' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m1209[0m       const investigation = await service.createInvestigation(investigationData)
[7m    [0m [91m                                          ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1192[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'timeline' does not exist on type 'string'.

[7m1192[0m       expect(report.timeline).toHaveLength(1000)
[7m    [0m [91m                    ~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1185[0m:[93m9[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'includeTimeline' does not exist in type 'InvestigationResult[]'.

[7m1185[0m         includeTimeline: true,
[7m    [0m [91m        ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1162[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'searchThreatData' does not exist on type 'ThreatHuntingService'.

[7m1162[0m       const results = await service.searchThreatData(searchData)
[7m    [0m [91m                                    ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1125[0m:[93m17[0m - [91merror[0m[90m ts(2551): [0mProperty 'createInvestigation' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m1125[0m         service.createInvestigation({
[7m    [0m [91m                ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1105[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'analyzeTimeline' does not exist on type 'ThreatHuntingService'.

[7m1105[0m       const analysis = await service.analyzeTimeline(timelineId)
[7m    [0m [91m                                     ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1098[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'data' does not exist on type 'HuntFinding[]'.

[7m1098[0m       expect(results.data).toHaveLength(0)
[7m    [0m [91m                     ~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1097[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'errors' does not exist on type 'HuntFinding[]'.

[7m1097[0m       expect(results.errors).toContain('Query execution failed')
[7m    [0m [91m                     ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1094[0m:[93m54[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'string' is not assignable to parameter of type 'Record<string, unknown>'.

[7m1094[0m       const results = await service.executeHuntQuery(queryId)
[7m    [0m [91m                                                     ~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1094[0m:[93m37[0m - [91merror[0m[90m ts(2341): [0mProperty 'executeHuntQuery' is private and only accessible within class 'ThreatHuntingService'.

[7m1094[0m       const results = await service.executeHuntQuery(queryId)
[7m    [0m [91m                                    ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1084[0m:[93m43[0m - [91merror[0m[90m ts(2551): [0mProperty 'createInvestigation' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m1084[0m       const investigation = await service.createInvestigation(invalidData)
[7m    [0m [91m                                          ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1069[0m:[93m43[0m - [91merror[0m[90m ts(2551): [0mProperty 'createInvestigation' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m1069[0m       const investigation = await service.createInvestigation(investigationData)
[7m    [0m [91m                                          ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1051[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'performRealTimeHunting' does not exist on type 'ThreatHuntingService'.

[7m1051[0m       const results = await service.performRealTimeHunting(huntingData)
[7m    [0m [91m                                    ~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1034[0m:[93m39[0m - [91merror[0m[90m ts(2339): [0mProperty 'detectRealTimeAnomalies' does not exist on type 'ThreatHuntingService'.

[7m1034[0m       const anomalies = await service.detectRealTimeAnomalies(realTimeData)
[7m    [0m [91m                                      ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1008[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'performRealTimeHunting' does not exist on type 'ThreatHuntingService'.

[7m1008[0m       const results = await service.performRealTimeHunting(huntingData)
[7m    [0m [91m                                    ~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m967[0m:[93m41[0m - [91merror[0m[90m ts(2339): [0mProperty 'predictFutureThreats' does not exist on type 'ThreatHuntingService'.

[7m967[0m       const predictions = await service.predictFutureThreats(historicalData)
[7m   [0m [91m                                        ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m932[0m:[93m41[0m - [91merror[0m[90m ts(2339): [0mProperty 'correlateThreatWithBehavior' does not exist on type 'ThreatHuntingService'.

[7m932[0m       const correlation = await service.correlateThreatWithBehavior(
[7m   [0m [91m                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m901[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'analyzePatterns' does not exist on type 'ThreatHuntingService'.

[7m901[0m       const analysis = await service.analyzePatterns(threatData)
[7m   [0m [91m                                     ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m848[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'searchThreatData' does not exist on type 'ThreatHuntingService'.

[7m848[0m       const results = await service.searchThreatData(searchData)
[7m   [0m [91m                                    ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m833[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'searchThreatData' does not exist on type 'ThreatHuntingService'.

[7m833[0m       const results = await service.searchThreatData(searchData)
[7m   [0m [91m                                    ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m802[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'searchThreatData' does not exist on type 'ThreatHuntingService'.

[7m802[0m       const results = await service.searchThreatData(searchData)
[7m   [0m [91m                                    ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m756[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'exportTimeline' does not exist on type 'ThreatHuntingService'.

[7m756[0m       const exported = await service.exportTimeline(timelineId, 'json')
[7m   [0m [91m                                     ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m738[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'analyzeTimeline' does not exist on type 'ThreatHuntingService'.

[7m738[0m       const analysis = await service.analyzeTimeline(timelineId)
[7m   [0m [91m                                     ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m685[0m:[93m45[0m - [91merror[0m[90m ts(2339): [0mProperty 'addTimelineEvent' does not exist on type 'ThreatHuntingService'.

[7m685[0m       const updatedTimeline = await service.addTimelineEvent(
[7m   [0m [91m                                            ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m648[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'createTimeline' does not exist on type 'ThreatHuntingService'.

[7m648[0m       const timeline = await service.createTimeline(
[7m   [0m [91m                                     ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m627[0m:[93m39[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleHunt' does not exist on type 'ThreatHuntingService'.

[7m627[0m       const scheduled = await service.scheduleHunt(queryId, scheduleData)
[7m   [0m [91m                                      ~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m607[0m:[93m45[0m - [91merror[0m[90m ts(2339): [0mProperty 'loadHuntTemplates' does not exist on type 'ThreatHuntingService'.

[7m607[0m       const loadedTemplates = await service.loadHuntTemplates()
[7m   [0m [91m                                            ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m584[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'saveHuntTemplate' does not exist on type 'ThreatHuntingService'.

[7m584[0m       const template = await service.saveHuntTemplate(templateData)
[7m   [0m [91m                                     ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m559[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'maxResultsPerQuery' does not exist on type 'ThreatHuntingConfig'.

[7m559[0m         service.config.maxResultsPerQuery - 1,
[7m   [0m [91m                       ~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m559[0m:[93m17[0m - [91merror[0m[90m ts(2341): [0mProperty 'config' is private and only accessible within class 'ThreatHuntingService'.

[7m559[0m         service.config.maxResultsPerQuery - 1,
[7m   [0m [91m                ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m552[0m:[93m54[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'string' is not assignable to parameter of type 'Record<string, unknown>'.

[7m552[0m       const results = await service.executeHuntQuery(queryId)
[7m   [0m [91m                                                     ~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m552[0m:[93m37[0m - [91merror[0m[90m ts(2341): [0mProperty 'executeHuntQuery' is private and only accessible within class 'ThreatHuntingService'.

[7m552[0m       const results = await service.executeHuntQuery(queryId)
[7m   [0m [91m                                    ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m511[0m:[93m39[0m - [91merror[0m[90m ts(2339): [0mProperty 'createHuntQuery' does not exist on type 'ThreatHuntingService'.

[7m511[0m       const huntQuery = await service.createHuntQuery(queryData)
[7m   [0m [91m                                      ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m480[0m:[93m22[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'any' is not assignable to parameter of type 'never'.

[7m480[0m         exports.push(exported)
[7m   [0m [91m                     ~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m463[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'format' does not exist on type 'string'.

[7m463[0m       expect(report.format).toBe('pdf')
[7m   [0m [91m                    ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m462[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'recommendations' does not exist on type 'string'.

[7m462[0m       expect(report.recommendations).toBeDefined()
[7m   [0m [91m                    ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m461[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'evidence' does not exist on type 'string'.

[7m461[0m       expect(report.evidence).toBeDefined()
[7m   [0m [91m                    ~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m460[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'timeline' does not exist on type 'string'.

[7m460[0m       expect(report.timeline).toBeDefined()
[7m   [0m [91m                    ~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m459[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'investigation' does not exist on type 'string'.

[7m459[0m       expect(report.investigation).toEqual(investigation)
[7m   [0m [91m                    ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m458[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'summary' does not exist on type 'string'.

[7m458[0m       expect(report.summary).toBeDefined()
[7m   [0m [91m                    ~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m451[0m:[93m9[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'includeTimeline' does not exist in type 'InvestigationResult[]'.

[7m451[0m         includeTimeline: true,
[7m   [0m [91m        ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m331[0m:[93m36[0m - [91merror[0m[90m ts(2339): [0mProperty 'getInvestigationsByPriority' does not exist on type 'ThreatHuntingService'.

[7m331[0m       const result = await service.getInvestigationsByPriority('high')
[7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m301[0m:[93m36[0m - [91merror[0m[90m ts(2551): [0mProperty 'getActiveInvestigations' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m301[0m       const result = await service.getActiveInvestigations()
[7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m235[0m:[93m49[0m - [91merror[0m[90m ts(2551): [0mProperty 'closeInvestigation' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m235[0m       const closedInvestigation = await service.closeInvestigation(
[7m   [0m [91m                                                ~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m210[0m:[93m35[0m - [91merror[0m[90m ts(2339): [0mProperty 'updatedAt' does not exist on type 'void'.

[7m210[0m       expect(updatedInvestigation.updatedAt).toBeDefined()
[7m   [0m [91m                                  ~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m209[0m:[93m35[0m - [91merror[0m[90m ts(2339): [0mProperty 'notes' does not exist on type 'void'.

[7m209[0m       expect(updatedInvestigation.notes).toBe(updateData.notes)
[7m   [0m [91m                                  ~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m208[0m:[93m35[0m - [91merror[0m[90m ts(2339): [0mProperty 'progress' does not exist on type 'void'.

[7m208[0m       expect(updatedInvestigation.progress).toBe(45)
[7m   [0m [91m                                  ~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m207[0m:[93m35[0m - [91merror[0m[90m ts(2339): [0mProperty 'status' does not exist on type 'void'.

[7m207[0m       expect(updatedInvestigation.status).toBe('in_progress')
[7m   [0m [91m                                  ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m204[0m:[93m9[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 2.

[7m204[0m         updateData,
[7m   [0m [91m        ~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m202[0m:[93m50[0m - [91merror[0m[90m ts(2341): [0mProperty 'updateInvestigation' is private and only accessible within class 'ThreatHuntingService'.

[7m202[0m       const updatedInvestigation = await service.updateInvestigation(
[7m   [0m [91m                                                 ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m169[0m:[93m43[0m - [91merror[0m[90m ts(2551): [0mProperty 'createInvestigation' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m169[0m       const investigation = await service.createInvestigation(investigationData)
[7m   [0m [91m                                          ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m146[0m:[93m28[0m - [91merror[0m[90m ts(2341): [0mProperty 'config' is private and only accessible within class 'ThreatHuntingService'.

[7m146[0m       expect(customService.config).toEqual(customConfig)
[7m   [0m [91m                           ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m140[0m:[93m9[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 6.

[7m140[0m         mockOrchestrator,
[7m   [0m [91m        ~~~~~~~~~~~~~~~~~[0m
[7m141[0m         mockAIService,
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~[0m
[7m...[0m 
[7m143[0m         mockPredictiveService,
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m144[0m         customConfig,
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m112[0m:[93m29[0m - [91merror[0m[90m ts(2341): [0mProperty 'config' is private and only accessible within class 'ThreatHuntingService'.

[7m112[0m       expect(defaultService.config).toEqual({
[7m   [0m [91m                            ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m107[0m:[93m9[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 5.

[7m107[0m         mockOrchestrator,
[7m   [0m [91m        ~~~~~~~~~~~~~~~~~[0m
[7m108[0m         mockAIService,
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~[0m
[7m109[0m         mockBehavioralService,
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m110[0m         mockPredictiveService,
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m101[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'huntQueries' does not exist on type 'ThreatHuntingService'.

[7m101[0m       expect(service.huntQueries).toBeDefined()
[7m   [0m [91m                     ~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m100[0m:[93m22[0m - [91merror[0m[90m ts(2551): [0mProperty 'investigations' does not exist on type 'ThreatHuntingService'. Did you mean 'getInvestigation'?

[7m100[0m       expect(service.investigations).toBeDefined()
[7m   [0m [91m                     ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m99[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'predictiveService' does not exist on type 'ThreatHuntingService'.

[7m99[0m       expect(service.predictiveService).toBe(mockPredictiveService)
[7m  [0m [91m                     ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m98[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'behavioralService' does not exist on type 'ThreatHuntingService'.

[7m98[0m       expect(service.behavioralService).toBe(mockBehavioralService)
[7m  [0m [91m                     ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m97[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'aiService' does not exist on type 'ThreatHuntingService'.

[7m97[0m       expect(service.aiService).toBe(mockAIService)
[7m  [0m [91m                     ~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m96[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'orchestrator' does not exist on type 'ThreatHuntingService'.

[7m96[0m       expect(service.orchestrator).toBe(mockOrchestrator)
[7m  [0m [91m                     ~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m95[0m:[93m22[0m - [91merror[0m[90m ts(2341): [0mProperty 'redis' is private and only accessible within class 'ThreatHuntingService'.

[7m95[0m       expect(service.redis).toBe(mockRedis)
[7m  [0m [91m                     ~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m94[0m:[93m22[0m - [91merror[0m[90m ts(2341): [0mProperty 'config' is private and only accessible within class 'ThreatHuntingService'.

[7m94[0m       expect(service.config).toBeDefined()
[7m  [0m [91m                     ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m80[0m:[93m7[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 5.

[7m80[0m       mockOrchestrator,
[7m  [0m [91m      ~~~~~~~~~~~~~~~~~[0m
[7m81[0m       mockAIService,
[7m  [0m [91m~~~~~~~~~~~~~~~~~~~~[0m
[7m82[0m       mockBehavioralService,
[7m  [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m83[0m       mockPredictiveService,
[7m  [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m15[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../investigation-utils"' has no exported member 'exportInvestigationData'.

[7m15[0m   exportInvestigationData,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m13[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../investigation-utils"' has no exported member 'closeInvestigation'.

[7m13[0m   closeInvestigation,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m12[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../investigation-utils"' has no exported member 'updateInvestigation'.

[7m12[0m   updateInvestigation,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m11[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../investigation-utils"' has no exported member 'createInvestigation'.

[7m11[0m   createInvestigation,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1184[0m:[93m22[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m1184[0m       const report = await generateInvestigationReport(investigation, {
[7m    [0m [93m                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1185[0m         includeTimeline: true,
[7m    [0m [93m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1187[0m         includeRecommendations: true,
[7m    [0m [93m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1188[0m       })
[7m    [0m [93m~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1134[0m:[93m32[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'index' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m1134[0m       results.forEach((result, index) => {
[7m    [0m [93m                               ~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m1134[0m:[93m24[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'result' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m1134[0m       results.forEach((result, index) => {
[7m    [0m [93m                       ~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/__tests__/threat-hunting.test.ts[0m:[93m450[0m:[93m22[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m450[0m       const report = await generateInvestigationReport(investigation, {
[7m   [0m [93m                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m451[0m         includeTimeline: true,
[7m   [0m [93m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m...[0m 
[7m454[0m         format: 'pdf',
[7m   [0m [93m~~~~~~~~~~~~~~~~~~~~~~[0m
[7m455[0m       })
[7m   [0m [93m~~~~~~~~[0m

[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m104[0m:[93m18[0m - [91merror[0m[90m ts(18046): [0m'items' is of type 'unknown'.

[7m104[0m       frequency: items.length,
[7m   [0m [91m                 ~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m87[0m:[93m20[0m - [91merror[0m[90m ts(18046): [0m'items' is of type 'unknown'.

[7m87[0m     const sorted = items
[7m  [0m [91m                   ~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m85[0m:[93m9[0m - [91merror[0m[90m ts(18046): [0m'items' is of type 'unknown'.

[7m85[0m     if (items.length < 3) continue
[7m  [0m [91m        ~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m11[0m:[93m58[0m - [91merror[0m[90m ts(2307): [0mCannot find module '../types' or its corresponding type declarations.

[7m11[0m import { ThreatData, ThreatPattern, ThreatFinding } from '../types'
[7m  [0m [91m                                                         ~~~~~~~~~~[0m
[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m109[0m:[93m36[0m - [93mwarning[0m[90m ts(7044): [0mParameter 's' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m109[0m       related_threats: sorted.map((s) => s.id),
[7m   [0m [93m                                   ~[0m
[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m97[0m:[93m22[0m - [93mwarning[0m[90m ts(7044): [0mParameter 's' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m97[0m       ...sorted.map((s) => new Date(s.timestamp).getTime()),
[7m  [0m [93m                     ~[0m
[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m94[0m:[93m22[0m - [93mwarning[0m[90m ts(7044): [0mParameter 's' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m94[0m       ...sorted.map((s) => new Date(s.timestamp).getTime()),
[7m  [0m [93m                     ~[0m
[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m90[0m:[93m13[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'b' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m90[0m         (a, b) =>
[7m  [0m [93m            ~[0m
[96msrc/lib/threat-detection/threat-hunting/utils/threat-data-utils.ts[0m:[93m90[0m:[93m10[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'a' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m90[0m         (a, b) =>
[7m  [0m [93m         ~[0m

[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1527[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'ThreatIntelligenceConfigManager'.

[7m1527[0m export { ThreatIntelligenceConfigManager }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1527[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatIntelligenceConfigManager'.

[7m1527[0m export { ThreatIntelligenceConfigManager }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1500[0m:[93m54[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m1500[0m       issues.push('Environment validation error: ' + error.message)
[7m    [0m [91m                                                     ~~~~~[0m
[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1491[0m:[93m53[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m1491[0m         issues.push('MongoDB connection failed: ' + error.message)
[7m    [0m [91m                                                    ~~~~~[0m
[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1485[0m:[93m51[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m1485[0m         issues.push('Redis connection failed: ' + error.message)
[7m    [0m [91m                                                  ~~~~~[0m
[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1115[0m:[93m15[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'Db'.

[7m1115[0m   private db: Db
[7m    [0m [91m              ~~[0m
[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1114[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m1114[0m   private mongoClient: MongoClient
[7m    [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1113[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m1113[0m   private redis: Redis
[7m    [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/config/ThreatIntelligenceConfig.ts[0m:[93m1111[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatIntelligenceConfigManager'.

[7m1111[0m export class ThreatIntelligenceConfigManager {
[7m    [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1590[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'ThreatCorrelationEngineCore'.

[7m1590[0m export { ThreatCorrelationEngineCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1590[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatCorrelationEngineCore'.

[7m1590[0m export { ThreatCorrelationEngineCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1326[0m:[93m55[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'CorrelationPattern | null' is not assignable to parameter of type 'WithoutId<Document>'.
  Type 'null' is not assignable to type 'WithoutId<Document>'.

[7m1326[0m         .replaceOne({ patternId: pattern.patternId }, pattern, { upsert: true })
[7m    [0m [91m                                                      ~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1326[0m:[93m34[0m - [91merror[0m[90m ts(18047): [0m'pattern' is possibly 'null'.

[7m1326[0m         .replaceOne({ patternId: pattern.patternId }, pattern, { upsert: true })
[7m    [0m [91m                                 ~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1322[0m:[93m55[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'CorrelationPattern | null' is not assignable to parameter of type 'CorrelationPattern'.
  Type 'null' is not assignable to type 'CorrelationPattern'.

[7m1322[0m       this.correlationPatterns.set(pattern.patternId, pattern)
[7m    [0m [91m                                                      ~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1322[0m:[93m36[0m - [91merror[0m[90m ts(18047): [0m'pattern' is possibly 'null'.

[7m1322[0m       this.correlationPatterns.set(pattern.patternId, pattern)
[7m    [0m [91m                                   ~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1319[0m:[93m54[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'CorrelationPattern | null' is not assignable to parameter of type 'CorrelationPattern'.
  Type 'null' is not assignable to type 'CorrelationPattern'.

[7m1319[0m       pattern.trend = await this.analyzePatternTrend(pattern)
[7m    [0m [91m                                                     ~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1319[0m:[93m7[0m - [91merror[0m[90m ts(18047): [0m'pattern' is possibly 'null'.

[7m1319[0m       pattern.trend = await this.analyzePatternTrend(pattern)
[7m    [0m [91m      ~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1306[0m:[93m11[0m - [91merror[0m[90m ts(2322): [0mType 'string' is not assignable to type '"behavioral" | "temporal" | "attribution" | "spatial"'.

[7m1306[0m           patternType: patternInfo.type,
[7m    [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1031[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'WithId<Document>[]' is not assignable to type 'GlobalThreatIntelligence[]'.
  Type 'WithId<Document>' is missing the following properties from type 'GlobalThreatIntelligence': intelligenceId, threatId, globalThreatId, regions, and 8 more.

[7m1031[0m       return similarThreatData
[7m    [0m [91m      ~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m1008[0m:[93m15[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'WithId<Document>' is not assignable to parameter of type 'GlobalThreatIntelligence'.
  Type 'WithId<Document>' is missing the following properties from type 'GlobalThreatIntelligence': intelligenceId, threatId, globalThreatId, regions, and 8 more.

[7m1008[0m               targetThreat,
[7m    [0m [91m              ~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m995[0m:[93m11[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'WithId<Document>' is not assignable to parameter of type 'GlobalThreatIntelligence'.
  Type 'WithId<Document>' is missing the following properties from type 'GlobalThreatIntelligence': intelligenceId, threatId, globalThreatId, regions, and 8 more.

[7m995[0m           targetThreat,
[7m   [0m [91m          ~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m759[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'WithId<Document>[]' is not assignable to type 'GlobalThreatIntelligence[]'.
  Type 'WithId<Document>' is missing the following properties from type 'GlobalThreatIntelligence': intelligenceId, threatId, globalThreatId, regions, and 8 more.

[7m759[0m       return similarThreats
[7m   [0m [91m      ~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m679[0m:[93m5[0m - [91merror[0m[90m ts(2322): [0mType 'string | boolean | undefined' is not assignable to type 'boolean'.
  Type 'undefined' is not assignable to type 'boolean'.

[7m679[0m     return (
[7m   [0m [91m    ~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m492[0m:[93m11[0m - [91merror[0m[90m ts(2322): [0mType 'number' is not assignable to type 'never'.

[7m492[0m           matrix[i][j] = Math.min(
[7m   [0m [91m          ~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m484[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'number' is not assignable to type 'never'.

[7m484[0m       matrix[0][j] = j
[7m   [0m [91m      ~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m480[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'number[]' is not assignable to type 'never'.

[7m480[0m       matrix[i] = [i]
[7m   [0m [91m      ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m199[0m:[93m57[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'WithId<Document>' is not assignable to parameter of type 'CorrelationPattern'.
  Type 'WithId<Document>' is missing the following properties from type 'CorrelationPattern': patternId, patternType, description, confidence, and 6 more.

[7m199[0m         this.correlationPatterns.set(pattern.patternId, pattern)
[7m   [0m [91m                                                        ~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m75[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'db' has no initializer and is not definitely assigned in the constructor.

[7m75[0m   private db: Db
[7m  [0m [91m          ~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m74[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m74[0m   private mongoClient: MongoClient
[7m  [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m73[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m73[0m   private redis: Redis
[7m  [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m69[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatCorrelationEngineCore'.

[7m69[0m export class ThreatCorrelationEngineCore
[7m  [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/correlation/ThreatCorrelationEngine.ts[0m:[93m17[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'ThreatIndicator'.

[7m17[0m   ThreatIndicator,
[7m  [0m [91m  ~~~~~~~~~~~~~~~[0m

[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m1220[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'ThreatIntelligenceDatabaseCore'.

[7m1220[0m export { ThreatIntelligenceDatabaseCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m1220[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatIntelligenceDatabaseCore'.

[7m1220[0m export { ThreatIntelligenceDatabaseCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m930[0m:[93m9[0m - [91merror[0m[90m ts(2322): [0mType 'WithId<Document>[]' is not assignable to type 'GlobalThreatIntelligence[]'.
  Type 'WithId<Document>' is missing the following properties from type 'GlobalThreatIntelligence': intelligenceId, threatId, globalThreatId, regions, and 8 more.

[7m930[0m         data: threats,
[7m   [0m [91m        ~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m758[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'WithId<Document>[]' is not assignable to type 'GlobalThreatIntelligence[]'.
  Type 'WithId<Document>' is missing the following properties from type 'GlobalThreatIntelligence': intelligenceId, threatId, globalThreatId, regions, and 8 more.

[7m758[0m       return threats
[7m   [0m [91m      ~~~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m649[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'WithId<Document> | null' is not assignable to type 'GlobalThreatIntelligence | null'.
  Type 'WithId<Document>' is not assignable to type 'GlobalThreatIntelligence | null'.

[7m649[0m       return threat
[7m   [0m [91m      ~~~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m621[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'WithId<Document> | null' is not assignable to type 'GlobalThreatIntelligence | null'.
  Type 'WithId<Document>' is not assignable to type 'GlobalThreatIntelligence | null'.

[7m621[0m       return threat
[7m   [0m [91m      ~~~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m101[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m101[0m   private redis: Redis
[7m   [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m100[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'db' has no initializer and is not definitely assigned in the constructor.

[7m100[0m   private db: Db
[7m   [0m [91m          ~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m99[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m99[0m   private mongoClient: MongoClient
[7m  [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m95[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatIntelligenceDatabaseCore'.

[7m95[0m export class ThreatIntelligenceDatabaseCore
[7m  [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/database/ThreatIntelligenceDatabase.ts[0m:[93m915[0m:[93m13[0m - [93mwarning[0m[90m ts(6133): [0m'totalCount' is declared but its value is never read.

[7m915[0m       const totalCount = await threatsCollection.countDocuments(searchQuery)
[7m   [0m [93m            ~~~~~~~~~~[0m

[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m1177[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'EdgeThreatDetectionSystemCore'.

[7m1177[0m export { EdgeThreatDetectionSystemCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m1177[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'EdgeThreatDetectionSystemCore'.

[7m1177[0m export { EdgeThreatDetectionSystemCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m521[0m:[93m66[0m - [91merror[0m[90m ts(2551): [0mProperty 'threatData' does not exist on type 'RealTimeThreatData'. Did you mean 'threatId'?

[7m521[0m       this.emit('detection_error', { error, threatId: threatData.threatData })
[7m   [0m [91m                                                                 ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m492[0m:[93m9[0m - [91merror[0m[90m ts(2322): [0mType 'string' is not assignable to type 'number'.
  Type 'string' is not assignable to type 'number'.

[7m492[0m         severity: finalResult.severity,
[7m   [0m [91m        ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m399[0m:[93m40[0m - [91merror[0m[90m ts(2339): [0mProperty 'regions' does not exist on type 'EdgeDetectionConfig'.

[7m399[0m       for (const region of this.config.regions || []) {
[7m   [0m [91m                                       ~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m66[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m66[0m   private redis: Redis
[7m  [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m62[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'EdgeThreatDetectionSystemCore'.

[7m62[0m export class EdgeThreatDetectionSystemCore
[7m  [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m16[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'ThreatIndicator'.

[7m16[0m   ThreatIndicator,
[7m  [0m [91m  ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m1168[0m:[93m11[0m - [93mwarning[0m[90m ts(6196): [0m'RegionStatus' is declared but never used.

[7m1168[0m interface RegionStatus {
[7m    [0m [93m          ~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m797[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'classificationResult' is declared but its value is never read.

[7m797[0m     classificationResult: ClassificationResult,
[7m   [0m [93m    ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m730[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'features' is declared but its value is never read.

[7m730[0m     features: number[],
[7m   [0m [93m    ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m706[0m:[93m27[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m706[0m       const prediction = (await predictionModel.predict(input)) as tf.Tensor
[7m   [0m [93m                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m642[0m:[93m27[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m642[0m       const prediction = (await classificationModel.predict(input)) as tf.Tensor
[7m   [0m [93m                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m602[0m:[93m27[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m602[0m       const prediction = (await anomalyModel.predict(input)) as tf.Tensor
[7m   [0m [93m                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m344[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'modelConfig' is declared but its value is never read.

[7m344[0m     modelConfig: AIModelConfig,
[7m   [0m [93m    ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m309[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'modelConfig' is declared but its value is never read.

[7m309[0m     modelConfig: AIModelConfig,
[7m   [0m [93m    ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m270[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'modelConfig' is declared but its value is never read.

[7m270[0m     modelConfig: AIModelConfig,
[7m   [0m [93m    ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m206[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'modelConfig' is declared but its value is never read.

[7m206[0m     modelConfig: AIModelConfig,
[7m   [0m [93m    ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/edge/EdgeThreatDetectionSystem.ts[0m:[93m69[0m:[93m11[0m - [93mwarning[0m[90m ts(6133): [0m'detectionThresholds' is declared but its value is never read.

[7m69[0m   private detectionThresholds: DetectionThresholds
[7m  [0m [93m          ~~~~~~~~~~~~~~~~~~~[0m

[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1935[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'ExternalThreatFeedIntegrationCore'.

[7m1935[0m export { ExternalThreatFeedIntegrationCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1935[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ExternalThreatFeedIntegrationCore'.

[7m1935[0m export { ExternalThreatFeedIntegrationCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1900[0m:[93m9[0m - [91merror[0m[90m ts(2739): [0mType '{ family: any; campaign: string; confidence: any; }' is missing the following properties from type 'ThreatAttribution': actor, motivation, sophistication, resources, evidence

[7m1900[0m         attribution: {
[7m    [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1889[0m:[93m11[0m - [91merror[0m[90m ts(2739): [0mType '{ indicatorType: any; value: any; confidence: any; firstSeen: Date; lastSeen: Date; }' is missing the following properties from type 'GlobalThreatIndicator': indicatorId, sourceRegion, metadata

[7m1889[0m           {
[7m    [0m [91m          ~[0m
[7m1890[0m             indicatorType: item.indicatorType as any,
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1894[0m             lastSeen: new Date(item.timestamp),
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1895[0m           },
[7m    [0m [91m~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1796[0m:[93m9[0m - [91merror[0m[90m ts(2739): [0mType '{ family: any; campaign: string; confidence: any; }' is missing the following properties from type 'ThreatAttribution': actor, motivation, sophistication, resources, evidence

[7m1796[0m         attribution: {
[7m    [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1785[0m:[93m11[0m - [91merror[0m[90m ts(2739): [0mType '{ indicatorType: any; value: any; confidence: any; firstSeen: Date; lastSeen: Date; }' is missing the following properties from type 'GlobalThreatIndicator': indicatorId, sourceRegion, metadata

[7m1785[0m           {
[7m    [0m [91m          ~[0m
[7m1786[0m             indicatorType: item.indicatorType as any,
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1790[0m             lastSeen: new Date(item.timestamp),
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1791[0m           },
[7m    [0m [91m~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1669[0m:[93m9[0m - [91merror[0m[90m ts(2739): [0mType '{ family: any; campaign: string; confidence: any; }' is missing the following properties from type 'ThreatAttribution': actor, motivation, sophistication, resources, evidence

[7m1669[0m         attribution: {
[7m    [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1658[0m:[93m11[0m - [91merror[0m[90m ts(2739): [0mType '{ indicatorType: any; value: any; confidence: any; firstSeen: Date; lastSeen: Date; }' is missing the following properties from type 'GlobalThreatIndicator': indicatorId, sourceRegion, metadata

[7m1658[0m           {
[7m    [0m [91m          ~[0m
[7m1659[0m             indicatorType: item.indicatorType as any,
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1663[0m             lastSeen: new Date(item.timestamp),
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1664[0m           },
[7m    [0m [91m~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1541[0m:[93m9[0m - [91merror[0m[90m ts(2739): [0mType '{ family: any; campaign: string; confidence: any; }' is missing the following properties from type 'ThreatAttribution': actor, motivation, sophistication, resources, evidence

[7m1541[0m         attribution: {
[7m    [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1530[0m:[93m11[0m - [91merror[0m[90m ts(2739): [0mType '{ indicatorType: any; value: any; confidence: any; firstSeen: Date; lastSeen: Date; }' is missing the following properties from type 'GlobalThreatIndicator': indicatorId, sourceRegion, metadata

[7m1530[0m           {
[7m    [0m [91m          ~[0m
[7m1531[0m             indicatorType: item.indicatorType as any,
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1535[0m             lastSeen: new Date(item.timestamp),
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1536[0m           },
[7m    [0m [91m~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1413[0m:[93m9[0m - [91merror[0m[90m ts(2739): [0mType '{ family: any; campaign: string; confidence: any; }' is missing the following properties from type 'ThreatAttribution': actor, motivation, sophistication, resources, evidence

[7m1413[0m         attribution: {
[7m    [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1402[0m:[93m11[0m - [91merror[0m[90m ts(2739): [0mType '{ indicatorType: any; value: any; confidence: any; firstSeen: Date; lastSeen: Date; }' is missing the following properties from type 'GlobalThreatIndicator': indicatorId, sourceRegion, metadata

[7m1402[0m           {
[7m    [0m [91m          ~[0m
[7m1403[0m             indicatorType: item.indicatorType as any,
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1407[0m             lastSeen: new Date(item.timestamp),
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1408[0m           },
[7m    [0m [91m~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1285[0m:[93m9[0m - [91merror[0m[90m ts(2739): [0mType '{ family: any; campaign: string; confidence: any; }' is missing the following properties from type 'ThreatAttribution': actor, motivation, sophistication, resources, evidence

[7m1285[0m         attribution: {
[7m    [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m1274[0m:[93m11[0m - [91merror[0m[90m ts(2739): [0mType '{ indicatorType: any; value: any; confidence: any; firstSeen: Date; lastSeen: Date; }' is missing the following properties from type 'GlobalThreatIndicator': indicatorId, sourceRegion, metadata

[7m1274[0m           {
[7m    [0m [91m          ~[0m
[7m1275[0m             indicatorType: item.indicatorType as any,
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m ...[0m 
[7m1279[0m             lastSeen: new Date(item.timestamp),
[7m    [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m1280[0m           },
[7m    [0m [91m~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m78[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'httpClient' has no initializer and is not definitely assigned in the constructor.

[7m78[0m   private httpClient: AxiosInstance
[7m  [0m [91m          ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m77[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'db' has no initializer and is not definitely assigned in the constructor.

[7m77[0m   private db: Db
[7m  [0m [91m          ~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m76[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m76[0m   private mongoClient: MongoClient
[7m  [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m75[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m75[0m   private redis: Redis
[7m  [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m71[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ExternalThreatFeedIntegrationCore'.

[7m71[0m export class ExternalThreatFeedIntegrationCore
[7m  [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m16[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'FeedProcessingResult'.

[7m16[0m   FeedProcessingResult,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m15[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'FeedSubscription'.

[7m15[0m   FeedSubscription,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m14[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'FeedItem'.

[7m14[0m   FeedItem,
[7m  [0m [91m  ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m13[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'FeedConfig'.

[7m13[0m   FeedConfig,
[7m  [0m [91m  ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/feeds/ExternalThreatFeedIntegration.ts[0m:[93m83[0m:[93m23[0m - [93mwarning[0m[90m ts(6138): [0mProperty 'config' is declared but its value is never read.

[7m83[0m   constructor(private config: FeedConfig) {
[7m  [0m [93m                      ~~~~~~[0m

[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m970[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'GlobalThreatIntelligenceNetworkCore'.

[7m970[0m export { GlobalThreatIntelligenceNetworkCore }
[7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m970[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'GlobalThreatIntelligenceNetworkCore'.

[7m970[0m export { GlobalThreatIntelligenceNetworkCore }
[7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m688[0m:[93m52[0m - [91merror[0m[90m ts(2554): [0mExpected 0 arguments, but got 1.

[7m688[0m         this.validationSystem.getValidationMetrics(region),
[7m   [0m [91m                                                   ~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m655[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'validateIntelligence' does not exist on type 'ThreatValidationSystem'.

[7m655[0m         await this.validationSystem.validateIntelligence(intelligence)
[7m   [0m [91m                                    ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m274[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'validateIntelligence' does not exist on type 'ThreatValidationSystem'.

[7m274[0m         await this.validationSystem.validateIntelligence(globalThreat)
[7m   [0m [91m                                    ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m266[0m:[93m9[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'CorrelationData' is not assignable to parameter of type 'CorrelationData[]'.
  Type 'CorrelationData' is missing the following properties from type 'CorrelationData[]': length, pop, push, concat, and 35 more.

[7m266[0m         correlationData,
[7m   [0m [91m        ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m199[0m:[93m35[0m - [91merror[0m[90m ts(2693): [0m'ThreatValidationSystem' only refers to a type, but is being used as a value here.

[7m199[0m       this.validationSystem = new ThreatValidationSystem(this.config.validation)
[7m   [0m [91m                                  ~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m191[0m:[93m32[0m - [91merror[0m[90m ts(2693): [0m'ThreatHuntingSystem' only refers to a type, but is being used as a value here.

[7m191[0m       this.huntingSystem = new ThreatHuntingSystem()
[7m   [0m [91m                               ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m185[0m:[93m39[0m - [91merror[0m[90m ts(2693): [0m'AutomatedThreatResponseOrchestrator' only refers to a type, but is being used as a value here.

[7m185[0m       this.responseOrchestrator = new AutomatedThreatResponseOrchestrator(
[7m   [0m [91m                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m179[0m:[93m39[0m - [91merror[0m[90m ts(2693): [0m'ThreatIntelligenceDatabase' only refers to a type, but is being used as a value here.

[7m179[0m       this.intelligenceDatabase = new ThreatIntelligenceDatabase(
[7m   [0m [91m                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m173[0m:[93m36[0m - [91merror[0m[90m ts(2693): [0m'ThreatCorrelationEngine' only refers to a type, but is being used as a value here.

[7m173[0m       this.correlationEngine = new ThreatCorrelationEngine(
[7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m167[0m:[93m38[0m - [91merror[0m[90m ts(2693): [0m'EdgeThreatDetectionSystem' only refers to a type, but is being used as a value here.

[7m167[0m       this.edgeDetectionSystem = new EdgeThreatDetectionSystem(
[7m   [0m [91m                                     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m82[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'validationSystem' has no initializer and is not definitely assigned in the constructor.

[7m82[0m   private validationSystem: ThreatValidationSystem
[7m  [0m [91m          ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m80[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'huntingSystem' has no initializer and is not definitely assigned in the constructor.

[7m80[0m   private huntingSystem: ThreatHuntingSystem
[7m  [0m [91m          ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m79[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'responseOrchestrator' has no initializer and is not definitely assigned in the constructor.

[7m79[0m   private responseOrchestrator: AutomatedThreatResponseOrchestrator
[7m  [0m [91m          ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m78[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'intelligenceDatabase' has no initializer and is not definitely assigned in the constructor.

[7m78[0m   private intelligenceDatabase: ThreatIntelligenceDatabase
[7m  [0m [91m          ~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m77[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'correlationEngine' has no initializer and is not definitely assigned in the constructor.

[7m77[0m   private correlationEngine: ThreatCorrelationEngine
[7m  [0m [91m          ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m76[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'edgeDetectionSystem' has no initializer and is not definitely assigned in the constructor.

[7m76[0m   private edgeDetectionSystem: EdgeThreatDetectionSystem
[7m  [0m [91m          ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m74[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'db' has no initializer and is not definitely assigned in the constructor.

[7m74[0m   private db: Db
[7m  [0m [91m          ~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m73[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m73[0m   private mongoClient: MongoClient
[7m  [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m72[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m72[0m   private redis: Redis
[7m  [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m68[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'GlobalThreatIntelligenceNetworkCore'.

[7m68[0m export class GlobalThreatIntelligenceNetworkCore
[7m  [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m28[0m:[93m47[0m - [91merror[0m[90m ts(2307): [0mCannot find module '../integration/ExternalThreatFeedIntegration' or its corresponding type declarations.

[7m28[0m import { ExternalThreatFeedIntegration } from '../integration/ExternalThreatFeedIntegration'
[7m  [0m [91m                                              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m496[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'threatData' is declared but its value is never read.

[7m496[0m     threatData: RealTimeThreatData,
[7m   [0m [93m    ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m430[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'edgeDetectionResult' is declared but its value is never read.

[7m430[0m     edgeDetectionResult: any,
[7m   [0m [93m    ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m88[0m:[93m11[0m - [93mwarning[0m[90m ts(6133): [0m'isInitialized' is declared but its value is never read.

[7m88[0m   private isInitialized = false
[7m  [0m [93m          ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m86[0m:[93m11[0m - [93mwarning[0m[90m ts(6133): [0m'existingPredictiveService' is declared but its value is never read.

[7m86[0m   private existingPredictiveService: AdvancedPredictiveThreatIntelligence
[7m  [0m [93m          ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m85[0m:[93m11[0m - [93mwarning[0m[90m ts(6133): [0m'existingIntelligenceService' is declared but its value is never read.

[7m85[0m   private existingIntelligenceService: ExternalThreatIntelligenceService
[7m  [0m [93m          ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/GlobalThreatIntelligenceNetwork.ts[0m:[93m74[0m:[93m11[0m - [93mwarning[0m[90m ts(6133): [0m'db' is declared but its value is never read.

[7m74[0m   private db: Db
[7m  [0m [93m          ~~[0m

[96msrc/lib/threat-intelligence/global/types.ts[0m:[93m413[0m:[93m15[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ThreatIndicator'.

[7m413[0m   indicators: ThreatIndicator[]
[7m   [0m [91m              ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/types.ts[0m:[93m386[0m:[93m12[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ThreatContext'.

[7m386[0m   context: ThreatContext
[7m   [0m [91m           ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/global/types.ts[0m:[93m385[0m:[93m15[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ThreatIndicator'.

[7m385[0m   indicators: ThreatIndicator[]
[7m   [0m [91m              ~~~~~~~~~~~~~~~[0m

[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2757[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'ThreatHuntingSystemCore'.

[7m2757[0m export { ThreatHuntingSystemCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2757[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatHuntingSystemCore'.

[7m2757[0m export { ThreatHuntingSystemCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2629[0m:[93m29[0m - [91merror[0m[90m ts(2339): [0mProperty 'lastExecution' does not exist on type 'HuntSchedule'.

[7m2629[0m         ? new Date(schedule.lastExecution)
[7m    [0m [91m                            ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2628[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'lastExecution' does not exist on type 'HuntSchedule'.

[7m2628[0m       const lastExecution = schedule.lastExecution
[7m    [0m [91m                                     ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2615[0m:[93m43[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'WithId<Document>' is not assignable to parameter of type 'HuntSchedule'.
  Type 'WithId<Document>' is missing the following properties from type 'HuntSchedule': frequency, cronExpression, timezone, enabled

[7m2615[0m           await this.executeScheduledHunt(schedule)
[7m    [0m [91m                                          ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2613[0m:[93m69[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'WithId<Document>' is not assignable to parameter of type 'HuntSchedule'.
  Type 'WithId<Document>' is missing the following properties from type 'HuntSchedule': frequency, cronExpression, timezone, enabled

[7m2613[0m         const shouldExecute = await this.shouldExecuteScheduledHunt(schedule)
[7m    [0m [91m                                                                    ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2404[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'WithId<Document>[]' is not assignable to type 'HuntResult[]'.
  Type 'WithId<Document>' is missing the following properties from type 'HuntResult': resultId, huntId, timestamp, findings, metadata

[7m2404[0m       return results
[7m    [0m [91m      ~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2347[0m:[93m30[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2347[0m         scheduleId: schedule.scheduleId,
[7m    [0m [91m                             ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2339[0m:[93m30[0m - [91merror[0m[90m ts(2339): [0mProperty 'parameters' does not exist on type 'HuntSchedule'.

[7m2339[0m         parameters: schedule.parameters,
[7m    [0m [91m                             ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2338[0m:[93m27[0m - [91merror[0m[90m ts(2339): [0mProperty 'regions' does not exist on type 'HuntSchedule'.

[7m2338[0m         regions: schedule.regions,
[7m    [0m [91m                          ~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2337[0m:[93m25[0m - [91merror[0m[90m ts(2339): [0mProperty 'scope' does not exist on type 'HuntSchedule'.

[7m2337[0m         scope: schedule.scope,
[7m    [0m [91m                        ~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2336[0m:[93m29[0m - [91merror[0m[90m ts(2339): [0mProperty 'patternId' does not exist on type 'HuntSchedule'.

[7m2336[0m         patternId: schedule.patternId,
[7m    [0m [91m                            ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2335[0m:[93m39[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2335[0m         huntId: `scheduled_${schedule.scheduleId}_${Date.now()}`,
[7m    [0m [91m                                      ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2335[0m:[93m9[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'huntId' does not exist in type 'HuntQuery'.

[7m2335[0m         huntId: `scheduled_${schedule.scheduleId}_${Date.now()}`,
[7m    [0m [91m        ~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2331[0m:[93m30[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2331[0m         scheduleId: schedule.scheduleId,
[7m    [0m [91m                             ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2318[0m:[93m32[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2318[0m         { scheduleId: schedule.scheduleId },
[7m    [0m [91m                               ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2289[0m:[93m19[0m - [91merror[0m[90m ts(2339): [0mProperty 'patternId' does not exist on type 'HuntSchedule'.

[7m2289[0m     if (!schedule.patternId) {
[7m    [0m [91m                  ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2285[0m:[93m19[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2285[0m     if (!schedule.scheduleId) {
[7m    [0m [91m                  ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2277[0m:[93m23[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2277[0m       return schedule.scheduleId
[7m    [0m [91m                      ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2275[0m:[93m58[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2275[0m       this.emit('hunt_scheduled', { scheduleId: schedule.scheduleId })
[7m    [0m [91m                                                         ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2273[0m:[93m40[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2273[0m       this.scheduledHunts.set(schedule.scheduleId, timeout)
[7m    [0m [91m                                       ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2268[0m:[93m34[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2268[0m             scheduleId: schedule.scheduleId,
[7m    [0m [91m                                 ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2250[0m:[93m29[0m - [91merror[0m[90m ts(2339): [0mProperty 'patternId' does not exist on type 'HuntSchedule'.

[7m2250[0m         patternId: schedule.patternId,
[7m    [0m [91m                            ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2249[0m:[93m30[0m - [91merror[0m[90m ts(2339): [0mProperty 'scheduleId' does not exist on type 'HuntSchedule'.

[7m2249[0m         scheduleId: schedule.scheduleId,
[7m    [0m [91m                             ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m2097[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'threatType' does not exist on type 'GlobalThreatIntelligence'.

[7m2097[0m     return `${threat.threatType}:${indicatorKeys}`
[7m    [0m [91m                     ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m1957[0m:[93m19[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'execution'.

[7m1957[0m           huntId: execution.huntId,
[7m    [0m [91m                  ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m1950[0m:[93m9[0m - [91merror[0m[90m ts(2739): [0mType '{ family: any; campaign: string; confidence: any; }' is missing the following properties from type 'ThreatAttribution': actor, motivation, sophistication, resources, evidence

[7m1950[0m         attribution: {
[7m    [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m1949[0m:[93m18[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'execution'.

[7m1949[0m         regions: execution.regions || ['global'],
[7m    [0m [91m                 ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m411[0m:[93m33[0m - [91merror[0m[90m ts(2339): [0mProperty 'dataSources' does not exist on type 'HuntQuery'.

[7m411[0m       dataSources.push(...query.dataSources)
[7m   [0m [91m                                ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m410[0m:[93m15[0m - [91merror[0m[90m ts(2339): [0mProperty 'dataSources' does not exist on type 'HuntQuery'.

[7m410[0m     if (query.dataSources) {
[7m   [0m [91m              ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m353[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'regions' does not exist on type 'HuntQuery'.

[7m353[0m         regions: query.regions || ['all'],
[7m   [0m [91m                       ~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m351[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'scope' does not exist on type 'HuntQuery'.

[7m351[0m         scope: query.scope || ['global'],
[7m   [0m [91m                     ~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m347[0m:[93m23[0m - [91merror[0m[90m ts(2339): [0mProperty 'huntId' does not exist on type 'HuntQuery'.

[7m347[0m         huntId: query.huntId,
[7m   [0m [91m                      ~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m326[0m:[93m20[0m - [91merror[0m[90m ts(2339): [0mProperty 'customQuery' does not exist on type 'HuntQuery'.

[7m326[0m       query: query.customQuery!,
[7m   [0m [91m                   ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m310[0m:[93m58[0m - [91merror[0m[90m ts(2339): [0mProperty 'patternId' does not exist on type 'HuntQuery'.

[7m310[0m         throw new Error(`Hunt pattern not found: ${query.patternId}`)
[7m   [0m [91m                                                         ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m308[0m:[93m51[0m - [91merror[0m[90m ts(2339): [0mProperty 'patternId' does not exist on type 'HuntQuery'.

[7m308[0m       const pattern = this.huntPatterns.get(query.patternId!)
[7m   [0m [91m                                                  ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m302[0m:[93m17[0m - [91merror[0m[90m ts(2339): [0mProperty 'customQuery' does not exist on type 'HuntQuery'.

[7m302[0m       if (query.customQuery) {
[7m   [0m [91m                ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m290[0m:[93m27[0m - [91merror[0m[90m ts(2339): [0mProperty 'maxResults' does not exist on type 'HuntQuery'.

[7m290[0m         maxResults: query.maxResults || 1000,
[7m   [0m [91m                          ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m289[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'timeout' does not exist on type 'HuntQuery'.

[7m289[0m         timeout: query.timeout || 300000, // 5 minutes default
[7m   [0m [91m                       ~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m288[0m:[93m25[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'HuntQuery'.

[7m288[0m         priority: query.priority || 'medium',
[7m   [0m [91m                        ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m288[0m:[93m9[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'priority' does not exist in type 'HuntQuery'.

[7m288[0m         priority: query.priority || 'medium',
[7m   [0m [91m        ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m271[0m:[93m40[0m - [91merror[0m[90m ts(2339): [0mProperty 'timeRange' does not exist on type 'HuntQuery'.

[7m271[0m         const endTime = new Date(query.timeRange.endTime)
[7m   [0m [91m                                       ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m270[0m:[93m42[0m - [91merror[0m[90m ts(2339): [0mProperty 'timeRange' does not exist on type 'HuntQuery'.

[7m270[0m         const startTime = new Date(query.timeRange.startTime)
[7m   [0m [91m                                         ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m269[0m:[93m17[0m - [91merror[0m[90m ts(2339): [0mProperty 'timeRange' does not exist on type 'HuntQuery'.

[7m269[0m       if (query.timeRange) {
[7m   [0m [91m                ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m264[0m:[93m32[0m - [91merror[0m[90m ts(2339): [0mProperty 'scope' does not exist on type 'HuntQuery'.

[7m264[0m       if (query.scope && query.scope.length === 0) {
[7m   [0m [91m                               ~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m264[0m:[93m17[0m - [91merror[0m[90m ts(2339): [0mProperty 'scope' does not exist on type 'HuntQuery'.

[7m264[0m       if (query.scope && query.scope.length === 0) {
[7m   [0m [91m                ~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m259[0m:[93m38[0m - [91merror[0m[90m ts(2339): [0mProperty 'customQuery' does not exist on type 'HuntQuery'.

[7m259[0m       if (!query.patternId && !query.customQuery) {
[7m   [0m [91m                                     ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m259[0m:[93m18[0m - [91merror[0m[90m ts(2339): [0mProperty 'patternId' does not exist on type 'HuntQuery'.

[7m259[0m       if (!query.patternId && !query.customQuery) {
[7m   [0m [91m                 ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m255[0m:[93m18[0m - [91merror[0m[90m ts(2339): [0mProperty 'huntId' does not exist on type 'HuntQuery'.

[7m255[0m       if (!query.huntId) {
[7m   [0m [91m                 ~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m247[0m:[93m64[0m - [91merror[0m[90m ts(2339): [0mProperty 'huntId' does not exist on type 'HuntQuery'.

[7m247[0m       this.emit('hunt_execution_error', { error, huntId: query.huntId })
[7m   [0m [91m                                                               ~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m245[0m:[93m23[0m - [91merror[0m[90m ts(2339): [0mProperty 'huntId' does not exist on type 'HuntQuery'.

[7m245[0m         huntId: query.huntId,
[7m   [0m [91m                      ~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m238[0m:[93m32[0m - [91merror[0m[90m ts(2339): [0mProperty 'confidence' does not exist on type 'HuntResult'.

[7m238[0m         confidence: huntResult.confidence,
[7m   [0m [91m                               ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m237[0m:[93m39[0m - [91merror[0m[90m ts(2339): [0mProperty 'threatsDiscovered' does not exist on type 'HuntResult'.

[7m237[0m         threatsDiscovered: huntResult.threatsDiscovered,
[7m   [0m [91m                                      ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m236[0m:[93m33[0m - [91merror[0m[90m ts(2339): [0mProperty 'executionId' does not exist on type 'HuntResult'.

[7m236[0m         executionId: huntResult.executionId,
[7m   [0m [91m                                ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m229[0m:[93m11[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'dataSources' does not exist in type 'HuntMetadata'.

[7m229[0m           dataSources: execution.dataSources,
[7m   [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m173[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'scope' does not exist on type 'HuntQuery'.

[7m173[0m         scope: query.scope,
[7m   [0m [91m                     ~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m172[0m:[93m26[0m - [91merror[0m[90m ts(2339): [0mProperty 'patternId' does not exist on type 'HuntQuery'.

[7m172[0m         patternId: query.patternId,
[7m   [0m [91m                         ~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m171[0m:[93m23[0m - [91merror[0m[90m ts(2339): [0mProperty 'huntId' does not exist on type 'HuntQuery'.

[7m171[0m         huntId: query.huntId,
[7m   [0m [91m                      ~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m62[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'db' has no initializer and is not definitely assigned in the constructor.

[7m62[0m   private db: Db
[7m  [0m [91m          ~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m61[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m61[0m   private mongoClient: MongoClient
[7m  [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m60[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m60[0m   private redis: Redis
[7m  [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m56[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatHuntingSystemCore'.

[7m56[0m export class ThreatHuntingSystemCore
[7m  [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m19[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'ThreatIndicator'.

[7m19[0m   ThreatIndicator,
[7m  [0m [91m  ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m17[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'HuntExecution'.

[7m17[0m   HuntExecution,
[7m  [0m [91m  ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m15[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'HuntPattern'.

[7m15[0m   HuntPattern,
[7m  [0m [91m  ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m12[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'HuntingConfig'.

[7m12[0m   HuntingConfig,
[7m  [0m [91m  ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m655[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'pattern' is declared but its value is never read.

[7m655[0m     pattern: HuntPattern,
[7m   [0m [93m    ~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m602[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'pattern' is declared but its value is never read.

[7m602[0m     pattern: HuntPattern,
[7m   [0m [93m    ~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m567[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'pattern' is declared but its value is never read.

[7m567[0m     pattern: HuntPattern,
[7m   [0m [93m    ~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m533[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'pattern' is declared but its value is never read.

[7m533[0m     pattern: HuntPattern,
[7m   [0m [93m    ~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m499[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'pattern' is declared but its value is never read.

[7m499[0m     pattern: HuntPattern,
[7m   [0m [93m    ~~~~~~~[0m
[96msrc/lib/threat-intelligence/hunting/ThreatHuntingSystem.ts[0m:[93m465[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'pattern' is declared but its value is never read.

[7m465[0m     pattern: HuntPattern,
[7m   [0m [93m    ~~~~~~~[0m

[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m1632[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'AutomatedThreatResponseOrchestratorCore'.

[7m1632[0m export { AutomatedThreatResponseOrchestratorCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m1632[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'AutomatedThreatResponseOrchestratorCore'.

[7m1632[0m export { AutomatedThreatResponseOrchestratorCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m1359[0m:[93m43[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'ResponseStrategy'.

[7m1359[0m     if (strategy.priority < 0 || strategy.priority > 100) {
[7m    [0m [91m                                          ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m1359[0m:[93m18[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'ResponseStrategy'.

[7m1359[0m     if (strategy.priority < 0 || strategy.priority > 100) {
[7m    [0m [91m                 ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m1089[0m:[93m22[0m - [91merror[0m[90m ts(2339): [0mProperty 'enabled' does not exist on type 'IntegrationEndpoint'.

[7m1089[0m         if (endpoint.enabled !== false) {
[7m    [0m [91m                     ~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m671[0m:[93m41[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'ResponseAction'.

[7m671[0m       if (action.priority < 0 || action.priority > 10) {
[7m   [0m [91m                                        ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m671[0m:[93m18[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'ResponseAction'.

[7m671[0m       if (action.priority < 0 || action.priority > 10) {
[7m   [0m [91m                 ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m599[0m:[93m14[0m - [91merror[0m[90m ts(2678): [0mType '"rate_limit"' is not comparable to type '"alert" | "block" | "isolate" | "investigate" | "mitigate"'.

[7m599[0m         case 'rate_limit':
[7m   [0m [91m             ~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m574[0m:[93m52[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'ResponseAction'.

[7m574[0m       return actions.sort((a, b) => b.priority - a.priority)
[7m   [0m [91m                                                   ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m574[0m:[93m39[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'ResponseAction'.

[7m574[0m       return actions.sort((a, b) => b.priority - a.priority)
[7m   [0m [91m                                      ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m548[0m:[93m13[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'priority' does not exist in type 'ResponseAction'.

[7m548[0m             priority: 3,
[7m   [0m [91m            ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m531[0m:[93m13[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'priority' does not exist in type 'ResponseAction'.

[7m531[0m             priority: 5,
[7m   [0m [91m            ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m523[0m:[93m13[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'priority' does not exist in type 'ResponseAction'.

[7m523[0m             priority: 6,
[7m   [0m [91m            ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m506[0m:[93m13[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'priority' does not exist in type 'ResponseAction'.

[7m506[0m             priority: 7,
[7m   [0m [91m            ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m494[0m:[93m13[0m - [91merror[0m[90m ts(2322): [0mType '"rate_limit"' is not assignable to type '"alert" | "block" | "isolate" | "investigate" | "mitigate"'.

[7m494[0m             actionType: 'rate_limit',
[7m   [0m [91m            ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m480[0m:[93m13[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'priority' does not exist in type 'ResponseAction'.

[7m480[0m             priority: 9,
[7m   [0m [91m            ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m471[0m:[93m13[0m - [91merror[0m[90m ts(2353): [0mObject literal may only specify known properties, and 'priority' does not exist in type 'ResponseAction'.

[7m471[0m             priority: 10,
[7m   [0m [91m            ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m376[0m:[93m24[0m - [91merror[0m[90m ts(18046): [0m'condition.value' is of type 'unknown'.

[7m376[0m         return value < condition.value
[7m   [0m [91m                       ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m374[0m:[93m24[0m - [91merror[0m[90m ts(18046): [0m'condition.value' is of type 'unknown'.

[7m374[0m         return value > condition.value
[7m   [0m [91m                       ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m285[0m:[93m56[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'ResponseStrategy'.

[7m285[0m       matchingStrategies.sort((a, b) => b.priority - a.priority)
[7m   [0m [91m                                                       ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m285[0m:[93m43[0m - [91merror[0m[90m ts(2339): [0mProperty 'priority' does not exist on type 'ResponseStrategy'.

[7m285[0m       matchingStrategies.sort((a, b) => b.priority - a.priority)
[7m   [0m [91m                                          ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m223[0m:[93m32[0m - [91merror[0m[90m ts(2339): [0mProperty 'primaryType' does not exist on type 'ResponseStrategy'.

[7m223[0m         responseType: strategy.primaryType,
[7m   [0m [91m                               ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m161[0m:[93m58[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'WithId<Document>' is not assignable to parameter of type 'ResponseStrategy'.
  Type 'WithId<Document>' is missing the following properties from type 'ResponseStrategy': strategyId, threatTypes, severityLevels, responseActions, conditions

[7m161[0m         this.responseStrategies.set(strategy.strategyId, strategy)
[7m   [0m [91m                                                         ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m74[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'db' has no initializer and is not definitely assigned in the constructor.

[7m74[0m   private db: Db
[7m  [0m [91m          ~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m73[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m73[0m   private mongoClient: MongoClient
[7m  [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m72[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m72[0m   private redis: Redis
[7m  [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m68[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'AutomatedThreatResponseOrchestratorCore'.

[7m68[0m export class AutomatedThreatResponseOrchestratorCore
[7m  [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m18[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'ThreatResponse'.

[7m18[0m   ThreatResponse,
[7m  [0m [91m  ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m1100[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'response' is declared but its value is never read.

[7m1100[0m     response: ThreatResponse,
[7m    [0m [93m    ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/orchestration/AutomatedThreatResponseOrchestrator.ts[0m:[93m404[0m:[93m5[0m - [93mwarning[0m[90m ts(6133): [0m'threat' is declared but its value is never read.

[7m404[0m     threat: GlobalThreatIntelligence,
[7m   [0m [93m    ~~~~~~[0m

[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m525[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m525[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m517[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'synchronizeThreat' does not exist on type 'GlobalThreatIntelligenceNetworkCore'.

[7m517[0m       await network.synchronizeThreat(threatData)
[7m   [0m [91m                    ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m485[0m:[93m47[0m - [91merror[0m[90m ts(2345): [0mArgument of type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is not assignable to parameter of type 'RealTimeThreatData'.
  Type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is missing the following properties from type 'RealTimeThreatData': timestamp, region, context, source

[7m485[0m       await network.processThreatIntelligence(threatData)
[7m   [0m [91m                                              ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m458[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m458[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m449[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'getThreatById' does not exist on type 'GlobalThreatIntelligenceNetworkCore'.

[7m449[0m       const result2 = await network.getThreatById(threatId)
[7m   [0m [91m                                    ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m446[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'getThreatById' does not exist on type 'GlobalThreatIntelligenceNetworkCore'.

[7m446[0m       const result1 = await network.getThreatById(threatId)
[7m   [0m [91m                                    ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m438[0m:[93m57[0m - [91merror[0m[90m ts(2339): [0mProperty 'status' does not exist on type 'GlobalThreatIntelligence'.

[7m438[0m       const successfulResults = results.filter((r) => r.status === 'processed')
[7m   [0m [91m                                                        ~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m429[0m:[93m67[0m - [91merror[0m[90m ts(2345): [0mArgument of type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is not assignable to parameter of type 'RealTimeThreatData'.
  Type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is missing the following properties from type 'RealTimeThreatData': timestamp, region, context, source

[7m429[0m         threats.map((threat) => network.processThreatIntelligence(threat)),
[7m   [0m [91m                                                                  ~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m402[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m402[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m394[0m:[93m45[0m - [91merror[0m[90m ts(2345): [0mArgument of type '{ threatId: null; threatType: string; severity?: undefined; confidence?: undefined; indicators?: undefined; } | { threatId: string; threatType: string; severity?: undefined; confidence?: undefined; indicators?: undefined; } | { ...; } | { ...; } | { ...; }' is not assignable to parameter of type 'RealTimeThreatData'.
  Type '{ threatId: null; threatType: string; severity?: undefined; confidence?: undefined; indicators?: undefined; }' is missing the following properties from type 'RealTimeThreatData': timestamp, region, context, source

[7m394[0m           network.processThreatIntelligence(invalidThreat),
[7m   [0m [91m                                            ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m379[0m:[93m49[0m - [91merror[0m[90m ts(2345): [0mArgument of type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is not assignable to parameter of type 'RealTimeThreatData'.
  Type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is missing the following properties from type 'RealTimeThreatData': timestamp, region, context, source

[7m379[0m         await network.processThreatIntelligence(threatData)
[7m   [0m [91m                                                ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m348[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m348[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m337[0m:[93m37[0m - [91merror[0m[90m ts(2339): [0mProperty 'getThreatMetrics' does not exist on type 'GlobalThreatIntelligenceNetworkCore'.

[7m337[0m       const metrics = await network.getThreatMetrics()
[7m   [0m [91m                                    ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m333[0m:[93m27[0m - [91merror[0m[90m ts(2339): [0mProperty 'activeRegions' does not exist on type 'HealthStatus'.

[7m333[0m       expect(healthStatus.activeRegions).toBeGreaterThan(0)
[7m   [0m [91m                          ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m332[0m:[93m27[0m - [91merror[0m[90m ts(2339): [0mProperty 'message' does not exist on type 'HealthStatus'.

[7m332[0m       expect(healthStatus.message).toContain('healthy')
[7m   [0m [91m                          ~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m331[0m:[93m27[0m - [91merror[0m[90m ts(2339): [0mProperty 'healthy' does not exist on type 'HealthStatus'.

[7m331[0m       expect(healthStatus.healthy).toBe(true)
[7m   [0m [91m                          ~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m324[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m324[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m315[0m:[93m42[0m - [91merror[0m[90m ts(2339): [0mProperty 'correlateThreats' does not exist on type 'GlobalThreatIntelligenceNetworkCore'.

[7m315[0m       const correlations = await network.correlateThreats([])
[7m   [0m [91m                                         ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m307[0m:[93m42[0m - [91merror[0m[90m ts(2339): [0mProperty 'correlateThreats' does not exist on type 'GlobalThreatIntelligenceNetworkCore'.

[7m307[0m       const correlations = await network.correlateThreats(threats)
[7m   [0m [91m                                         ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m263[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m263[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m257[0m:[93m28[0m - [91merror[0m[90m ts(2339): [0mProperty 'synchronizeThreat' does not exist on type 'GlobalThreatIntelligenceNetworkCore'.

[7m257[0m       await expect(network.synchronizeThreat(threatData)).rejects.toThrow()
[7m   [0m [91m                           ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m229[0m:[93m36[0m - [91merror[0m[90m ts(2339): [0mProperty 'synchronizeThreat' does not exist on type 'GlobalThreatIntelligenceNetworkCore'.

[7m229[0m       const result = await network.synchronizeThreat(threatData)
[7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m205[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m205[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m199[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'status' does not exist on type 'GlobalThreatIntelligence'.

[7m199[0m       expect(result.status).toBe('duplicate')
[7m   [0m [91m                    ~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m197[0m:[93m62[0m - [91merror[0m[90m ts(2345): [0mArgument of type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is not assignable to parameter of type 'RealTimeThreatData'.
  Type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is missing the following properties from type 'RealTimeThreatData': timestamp, region, context, source

[7m197[0m       const result = await network.processThreatIntelligence(threatData)
[7m   [0m [91m                                                             ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m194[0m:[93m47[0m - [91merror[0m[90m ts(2345): [0mArgument of type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is not assignable to parameter of type 'RealTimeThreatData'.
  Type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; firstSeen: Date; lastSeen: Date; regions: string[]; }' is missing the following properties from type 'RealTimeThreatData': timestamp, region, context, source

[7m194[0m       await network.processThreatIntelligence(threatData)
[7m   [0m [91m                                              ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m169[0m:[93m43[0m - [91merror[0m[90m ts(2345): [0mArgument of type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: never[]; }' is not assignable to parameter of type 'RealTimeThreatData'.
  Type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: never[]; }' is missing the following properties from type 'RealTimeThreatData': timestamp, region, context, source

[7m169[0m         network.processThreatIntelligence(invalidThreat),
[7m   [0m [91m                                          ~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m156[0m:[93m21[0m - [91merror[0m[90m ts(2339): [0mProperty 'status' does not exist on type 'GlobalThreatIntelligence'.

[7m156[0m       expect(result.status).toBe('processed')
[7m   [0m [91m                    ~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m152[0m:[93m62[0m - [91merror[0m[90m ts(2345): [0mArgument of type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; ... 4 more ...; metadata: { ...; }; }' is not assignable to parameter of type 'RealTimeThreatData'.
  Type '{ threatId: string; threatType: string; severity: string; confidence: number; indicators: { indicatorType: string; value: string; confidence: number; firstSeen: Date; lastSeen: Date; }[]; ... 4 more ...; metadata: { ...; }; }' is missing the following properties from type 'RealTimeThreatData': timestamp, region, context, source

[7m152[0m       const result = await network.processThreatIntelligence(threatData)
[7m   [0m [91m                                                             ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m119[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m119[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m109[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m109[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/tests/GlobalThreatIntelligenceNetwork.test.ts[0m:[93m89[0m:[93m17[0m - [91merror[0m[90m ts(2554): [0mExpected 2 arguments, but got 1.

[7m89[0m       network = new GlobalThreatIntelligenceNetworkCore(mockConfig)
[7m  [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1581[0m:[93m10[0m - [91merror[0m[90m ts(2484): [0mExport declaration conflicts with exported declaration of 'ThreatValidationSystemCore'.

[7m1581[0m export { ThreatValidationSystemCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1581[0m:[93m10[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatValidationSystemCore'.

[7m1581[0m export { ThreatValidationSystemCore }
[7m    [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1279[0m:[93m60[0m - [91merror[0m[90m ts(2339): [0mProperty 'severity' does not exist on type 'ValidationRule'.

[7m1279[0m       !['low', 'medium', 'high', 'critical'].includes(rule.severity)
[7m    [0m [91m                                                           ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1278[0m:[93m12[0m - [91merror[0m[90m ts(2339): [0mProperty 'severity' does not exist on type 'ValidationRule'.

[7m1278[0m       rule.severity &&
[7m    [0m [91m           ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1273[0m:[93m31[0m - [91merror[0m[90m ts(2339): [0mProperty 'name' does not exist on type 'ValidationRule'.

[7m1273[0m     if (!rule.ruleId || !rule.name || !rule.ruleType) {
[7m    [0m [91m                              ~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1073[0m:[93m32[0m - [91merror[0m[90m ts(2339): [0mProperty 'threatType' does not exist on type 'GlobalThreatIntelligence'.

[7m1073[0m           'threatType': threat.threatType,
[7m    [0m [91m                               ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1028[0m:[93m28[0m - [91merror[0m[90m ts(2339): [0mProperty 'threatType' does not exist on type 'GlobalThreatIntelligence'.

[7m1028[0m         threatType: threat.threatType,
[7m    [0m [91m                           ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m999[0m:[93m57[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m999[0m         issues: ['Cross-reference validation error: ' + error.message],
[7m   [0m [91m                                                        ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m926[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'getNestedValue' does not exist on type 'ThreatValidationSystemCore'.

[7m926[0m     const value = this.getNestedValue(threat, condition.field)
[7m   [0m [91m                       ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m910[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'getNestedValue' does not exist on type 'ThreatValidationSystemCore'.

[7m910[0m     const value = this.getNestedValue(threat, condition.field)
[7m   [0m [91m                       ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m879[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'getNestedValue' does not exist on type 'ThreatValidationSystemCore'.

[7m879[0m     const value = this.getNestedValue(threat, condition.field)
[7m   [0m [91m                       ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m855[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'getNestedValue' does not exist on type 'ThreatValidationSystemCore'.

[7m855[0m     const value = this.getNestedValue(threat, condition.field)
[7m   [0m [91m                       ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m826[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'getNestedValue' does not exist on type 'ThreatValidationSystemCore'.

[7m826[0m     const value = this.getNestedValue(threat, condition.field)
[7m   [0m [91m                       ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m811[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'getNestedValue' does not exist on type 'ThreatValidationSystemCore'.

[7m811[0m     const value = this.getNestedValue(threat, condition.field)
[7m   [0m [91m                       ~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m802[0m:[93m51[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m802[0m         message: 'Condition evaluation error: ' + error.message,
[7m   [0m [91m                                                  ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m772[0m:[93m47[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m772[0m         issues: ['Rule application error: ' + error.message],
[7m   [0m [91m                                              ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m769[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'name' does not exist on type 'ValidationRule'.

[7m769[0m         ruleName: rule.name,
[7m   [0m [91m                       ~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m759[0m:[93m26[0m - [91merror[0m[90m ts(2339): [0mProperty 'severity' does not exist on type 'ValidationRule'.

[7m759[0m           severity: rule.severity,
[7m   [0m [91m                         ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m758[0m:[93m35[0m - [91merror[0m[90m ts(2551): [0mProperty 'conditions' does not exist on type 'ValidationRule'. Did you mean 'condition'?

[7m758[0m           conditionsApplied: rule.conditions.length,
[7m   [0m [91m                                  ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m752[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'name' does not exist on type 'ValidationRule'.

[7m752[0m         ruleName: rule.name,
[7m   [0m [91m                       ~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m739[0m:[93m36[0m - [91merror[0m[90m ts(2551): [0mProperty 'conditions' does not exist on type 'ValidationRule'. Did you mean 'condition'?

[7m739[0m       for (const condition of rule.conditions) {
[7m   [0m [91m                                   ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m721[0m:[93m47[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m721[0m           issues: ['Rule execution error: ' + error.message],
[7m   [0m [91m                                              ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m718[0m:[93m26[0m - [91merror[0m[90m ts(2339): [0mProperty 'name' does not exist on type 'ValidationRule'.

[7m718[0m           ruleName: rule.name,
[7m   [0m [91m                         ~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m696[0m:[93m41[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m696[0m         issues: ['Validation error: ' + error.message],
[7m   [0m [91m                                        ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m629[0m:[93m41[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m629[0m         issues: ['Validation error: ' + error.message],
[7m   [0m [91m                                        ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m461[0m:[93m46[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m461[0m         error: 'Format validation error: ' + error.message,
[7m   [0m [91m                                             ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m431[0m:[93m41[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m431[0m         issues: ['Validation error: ' + error.message],
[7m   [0m [91m                                        ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m353[0m:[93m41[0m - [91merror[0m[90m ts(18046): [0m'error' is of type 'unknown'.

[7m353[0m         issues: ['Validation error: ' + error.message],
[7m   [0m [91m                                        ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m342[0m:[93m33[0m - [91merror[0m[90m ts(2339): [0mProperty 'metadata' does not exist on type 'GlobalThreatIntelligence'.

[7m342[0m           hasMetadata: !!threat.metadata,
[7m   [0m [91m                                ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m296[0m:[93m19[0m - [91merror[0m[90m ts(2339): [0mProperty 'threatType' does not exist on type 'GlobalThreatIntelligence'.

[7m296[0m       if (!threat.threatType) {
[7m   [0m [91m                  ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m268[0m:[93m26[0m - [91merror[0m[90m ts(2339): [0mProperty 'threatType' does not exist on type 'GlobalThreatIntelligence'.

[7m268[0m       threatType: threat.threatType,
[7m   [0m [91m                         ~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m223[0m:[93m56[0m - [91merror[0m[90m ts(2339): [0mProperty 'validationThreshold' does not exist on type 'ValidationConfig'.

[7m223[0m       validation.isValid = overallScore >= this.config.validationThreshold
[7m   [0m [91m                                                       ~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m205[0m:[93m71[0m - [91merror[0m[90m ts(2339): [0mProperty 'metadata' does not exist on type 'GlobalThreatIntelligence'.

[7m205[0m         const metadataValidation = await this.validateMetadata(threat.metadata)
[7m   [0m [91m                                                                      ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m204[0m:[93m18[0m - [91merror[0m[90m ts(2339): [0mProperty 'metadata' does not exist on type 'GlobalThreatIntelligence'.

[7m204[0m       if (threat.metadata) {
[7m   [0m [91m                 ~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m141[0m:[93m47[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'WithId<Document>' is not assignable to parameter of type 'ValidationRule'.
  Type 'WithId<Document>' is missing the following properties from type 'ValidationRule': ruleId, ruleType, condition, threshold, action

[7m141[0m         this.validationRules.set(rule.ruleId, rule)
[7m   [0m [91m                                              ~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m64[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'db' has no initializer and is not definitely assigned in the constructor.

[7m64[0m   private db: Db
[7m  [0m [91m          ~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m63[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'mongoClient' has no initializer and is not definitely assigned in the constructor.

[7m63[0m   private mongoClient: MongoClient
[7m  [0m [91m          ~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m62[0m:[93m11[0m - [91merror[0m[90m ts(2564): [0mProperty 'redis' has no initializer and is not definitely assigned in the constructor.

[7m62[0m   private redis: Redis
[7m  [0m [91m          ~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m58[0m:[93m14[0m - [91merror[0m[90m ts(2323): [0mCannot redeclare exported variable 'ThreatValidationSystemCore'.

[7m58[0m export class ThreatValidationSystemCore
[7m  [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m18[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'ValidationMetrics'.

[7m18[0m   ValidationMetrics,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m17[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'ThreatIndicator'.

[7m17[0m   ThreatIndicator,
[7m  [0m [91m  ~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m15[0m:[93m3[0m - [91merror[0m[90m ts(2305): [0mModule '"../global/types"' has no exported member 'ThreatValidation'.

[7m15[0m   ThreatValidation,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m14[0m:[93m3[0m - [91merror[0m[90m ts(2724): [0m'"../global/types"' has no exported member named 'ValidationResult'. Did you mean 'ValidationRule'?

[7m14[0m   ValidationResult,
[7m  [0m [91m  ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1211[0m:[93m17[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'r' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m1211[0m           .map((r) => r.issues)
[7m    [0m [93m                ~[0m
[96msrc/lib/threat-intelligence/validation/ThreatValidationSystem.ts[0m:[93m1210[0m:[93m20[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'r' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m1210[0m           .filter((r) => !r.passed)
[7m    [0m [93m                   ~[0m

[96msrc/lib/utils/demo-helpers.integration.test.ts[0m:[93m124[0m:[93m53[0m - [91merror[0m[90m ts(2352): [0mConversion of type '{ ok: true; text: () => Promise<string>; headers: Map<string, string>; }' to type 'Response' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Type '{ ok: true; text: () => Promise<string>; headers: Map<string, string>; }' is missing the following properties from type 'Response': redirected, status, statusText, type, and 9 more.

[7m124[0m       vi.mocked(global.fetch).mockResolvedValueOnce({
[7m   [0m [91m                                                    ~[0m
[7m125[0m         ok: true,
[7m   [0m [91m~~~~~~~~~~~~~~~~~[0m
[7m...[0m 
[7m127[0m         headers: new Map([['content-type', 'application/json']]),
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m128[0m       } as Response)
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~[0m

[96msrc/lib/utils/demo-helpers.test.ts[0m:[93m351[0m:[93m9[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 2.

[7m351[0m         {
[7m   [0m [91m        ~[0m
[7m352[0m           overall: 0.5,
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m...[0m 
[7m360[0m           evaluation: 0.4,
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m361[0m         },
[7m   [0m [91m~~~~~~~~~[0m
[96msrc/lib/utils/demo-helpers.test.ts[0m:[93m189[0m:[93m9[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 2.

[7m189[0m         biasFactors,
[7m   [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/utils/demo-helpers.test.ts[0m:[93m167[0m:[93m9[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 2.

[7m167[0m         biasFactors,
[7m   [0m [91m        ~~~~~~~~~~~[0m
[96msrc/lib/utils/demo-helpers.test.ts[0m:[93m136[0m:[93m9[0m - [91merror[0m[90m ts(2554): [0mExpected 1 arguments, but got 2.

[7m136[0m         biasFactors,
[7m   [0m [91m        ~~~~~~~~~~~[0m

[96msrc/lib/utils/env.ts[0m:[93m59[0m:[93m7[0m - [91merror[0m[90m ts(2322): [0mType 'string' is not assignable to type 'void'.

[7m59[0m       return getEnv(prop) ?? ''
[7m  [0m [91m      ~~~~~~[0m

[96msrc/lib/utils/image-optimizer.ts[0m:[93m11[0m:[93m26[0m - [91merror[0m[90m ts(2559): [0mType '"image-optimizer"' has no properties in common with type 'LoggerOptions'.

[7m11[0m const logger = getLogger('image-optimizer')
[7m  [0m [91m                         ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/utils/image-optimizer.ts[0m:[93m217[0m:[93m14[0m - [93mwarning[0m[90m ts(6387): [0mThe signature '(start?: number | undefined, end?: number | undefined): Buffer<ArrayBuffer>' of 'buffer.slice' is deprecated.

[7m217[0m       buffer.slice(8, 12).toString('hex') === '41564946'
[7m   [0m [93m             ~~~~~[0m
[96msrc/lib/utils/image-optimizer.ts[0m:[93m212[0m:[93m14[0m - [93mwarning[0m[90m ts(6387): [0mThe signature '(start?: number | undefined, end?: number | undefined): Buffer<ArrayBuffer>' of 'buffer.slice' is deprecated.

[7m212[0m       buffer.slice(8, 12).toString('hex') === '57454250'
[7m   [0m [93m             ~~~~~[0m
[96msrc/lib/utils/image-optimizer.ts[0m:[93m206[0m:[93m26[0m - [93mwarning[0m[90m ts(6387): [0mThe signature '(start?: number | undefined, end?: number | undefined): Buffer<ArrayBuffer>' of 'buffer.slice' is deprecated.

[7m206[0m     const magic = buffer.slice(0, 12).toString('hex')
[7m   [0m [93m                         ~~~~~[0m

[96msrc/lib/utils/safe-fetch.ts[0m:[93m90[0m:[93m24[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'controller' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m90[0m       transform(chunk, controller) {
[7m  [0m [93m                       ~~~~~~~~~~[0m
[96msrc/lib/utils/safe-fetch.ts[0m:[93m90[0m:[93m17[0m - [93mwarning[0m[90m ts(7044): [0mParameter 'chunk' implicitly has an 'any' type, but a better type may be inferred from usage.

[7m90[0m       transform(chunk, controller) {
[7m  [0m [93m                ~~~~~[0m

[96msrc/lib/validation/index.ts[0m:[93m116[0m:[93m4[0m - [93mwarning[0m[90m ts(6385): [0m'(params?: string | { abort?: boolean | undefined; version?: "v1" | "v8" | "v2" | "v3" | "v4" | "v5" | "v6" | "v7" | undefined; error?: string | $ZodErrorMap<$ZodIssueInvalidStringFormat> | undefined; message?: string | undefined; } | undefined): ZodString' is deprecated.

[7m116[0m   .uuid()
[7m   [0m [93m   ~~~~[0m
[96msrc/lib/validation/index.ts[0m:[93m95[0m:[93m34[0m - [93mwarning[0m[90m ts(6387): [0mThe signature '(): $ZodFormattedError<output<T>, string>' of 'result.error.format' is deprecated.

[7m95[0m           details: result?.error.format(),
[7m  [0m [93m                                 ~~~~~~[0m
[96msrc/lib/validation/index.ts[0m:[93m51[0m:[93m34[0m - [93mwarning[0m[90m ts(6387): [0mThe signature '(): $ZodFormattedError<output<T>, string>' of 'result.error.format' is deprecated.

[7m51[0m           details: result?.error.format(),
[7m  [0m [93m                                 ~~~~~~[0m

[96msrc/lib/websocket/server.ts[0m:[93m47[0m:[93m13[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m47[0m             await this.handleStatusUpdate(clientId, message)
[7m  [0m [93m            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m316[0m:[93m32[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m316[0m       const handleConnection = (wss as unknown).handleConnection.bind(wss)
[7m   [0m [91m                               ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m285[0m:[93m32[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m285[0m       const handleConnection = (wss as unknown).handleConnection.bind(wss)
[7m   [0m [91m                               ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m260[0m:[93m8[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m260[0m       ;(wss as unknown).broadcastToSession(sessionId, {
[7m   [0m [91m       ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m257[0m:[93m8[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m257[0m       ;(wss as unknown).sessions.set(sessionId, new Set([clientId]))
[7m   [0m [91m       ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m231[0m:[93m32[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m231[0m       const handleConnection = (wss as unknown).handleConnection.bind(wss)
[7m   [0m [91m                               ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m213[0m:[93m32[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m213[0m       const handleConnection = (wss as unknown).handleConnection.bind(wss)
[7m   [0m [91m                               ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m190[0m:[93m32[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m190[0m       const handleConnection = (wss as unknown).handleConnection.bind(wss)
[7m   [0m [91m                               ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m154[0m:[93m32[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m154[0m       const handleConnection = (wss as unknown).handleConnection.bind(wss)
[7m   [0m [91m                               ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m114[0m:[93m32[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m114[0m       const handleConnection = (wss as unknown).handleConnection.bind(wss)
[7m   [0m [91m                               ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m100[0m:[93m17[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ConnectionHandler'.

[7m100[0m       )?.[1] as ConnectionHandler
[7m   [0m [91m                ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m99[0m:[93m25[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'ConnectionHandler'.

[7m99[0m         (call: [string, ConnectionHandler]) => call[0] === 'connection',
[7m  [0m [91m                        ~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m99[0m:[93m9[0m - [91merror[0m[90m ts(2769): [0mNo overload matches this call.
  Overload 1 of 2, '(predicate: (value: any[], index: number, obj: any[][]) => value is any[], thisArg?: any): any[] | undefined', gave the following error.
  Overload 2 of 2, '(predicate: (value: any[], index: number, obj: any[][]) => unknown, thisArg?: any): any[] | undefined', gave the following error.

[7m99[0m         (call: [string, ConnectionHandler]) => call[0] === 'connection',
[7m  [0m [91m        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m83[0m:[93m19[0m - [91merror[0m[90m ts(2571): [0mObject is of type 'unknown'.

[7m83[0m     mockClients = (wss as unknown).clients
[7m  [0m [91m                  ~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m72[0m:[93m25[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'MockWebSocket'.

[7m72[0m     mockWebSocket = new MockWebSocket() as WebSocket & {
[7m  [0m [91m                        ~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m333[0m:[93m7[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m333[0m       await messageHandler(JSON.stringify(message))
[7m   [0m [93m      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m309[0m:[93m7[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m309[0m       await messageHandler(JSON.stringify(encryptedMessage))
[7m   [0m [93m      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m243[0m:[93m7[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m243[0m       await messageHandler('invalid json')
[7m   [0m [93m      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m208[0m:[93m7[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m208[0m       await messageHandler(JSON.stringify(statusMessage))
[7m   [0m [93m      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m179[0m:[93m7[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m179[0m       await messageHandler(JSON.stringify(encryptedMessage))
[7m   [0m [93m      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/websocket/__tests__/server.test.ts[0m:[93m149[0m:[93m7[0m - [93mwarning[0m[90m ts(80007): [0m'await' has no effect on the type of this expression.

[7m149[0m       await messageHandler(JSON.stringify(chatMessage))
[7m   [0m [93m      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

[96msrc/load-tests/breach-notification.load.ts[0m:[93m192[0m:[93m24[0m - [91merror[0m[90m ts(2339): [0mProperty 'notificationStatus' does not exist on type 'void'.

[7m192[0m     if (statusResponse.notificationStatus === 'completed') {
[7m   [0m [91m                       ~~~~~~~~~~~~~~~~~~[0m
[96msrc/load-tests/breach-notification.load.ts[0m:[93m7[0m:[93m38[0m - [91merror[0m[90m ts(2307): [0mCannot find module 'k6/http' or its corresponding type declarations.

[7m7[0m import type { RefinedResponse } from 'k6/http'
[7m [0m [91m                                     ~~~~~~~~~[0m
[96msrc/load-tests/breach-notification.load.ts[0m:[93m6[0m:[93m38[0m - [91merror[0m[90m ts(2307): [0mCannot find module 'k6/metrics' or its corresponding type declarations.

[7m6[0m import { Counter, Rate, Trend } from 'k6/metrics'
[7m [0m [91m                                     ~~~~~~~~~~~~[0m
[96msrc/load-tests/breach-notification.load.ts[0m:[93m5[0m:[93m18[0m - [91merror[0m[90m ts(2307): [0mCannot find module 'k6/http' or its corresponding type declarations.

[7m5[0m import http from 'k6/http'
[7m [0m [91m                 ~~~~~~~~~[0m
[96msrc/load-tests/breach-notification.load.ts[0m:[93m4[0m:[93m30[0m - [91merror[0m[90m ts(2307): [0mCannot find module 'k6/data' or its corresponding type declarations.

[7m4[0m import { randomString } from 'k6/data'
[7m [0m [91m                             ~~~~~~~~~[0m
[96msrc/load-tests/breach-notification.load.ts[0m:[93m3[0m:[93m30[0m - [91merror[0m[90m ts(2307): [0mCannot find module 'k6' or its corresponding type declarations.

[7m3[0m import { check, sleep } from 'k6'
[7m [0m [91m                             ~~~~[0m

[96msrc/middleware/monitoring.ts[0m:[93m51[0m:[93m34[0m - [91merror[0m[90m ts(2345): [0mArgument of type 'unknown' is not assignable to parameter of type 'string'.

[7m51[0m       const session = JSON.parse(decodeURIComponent(sessionCookie) as unknown)
[7m  [0m [91m                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

[96msrc/middleware/security.ts[0m:[93m318[0m:[93m57[0m - [91merror[0m[90m ts(2304): [0mCannot find name 'CORS_CONFIG'.

[7m318[0m export { SECURITY_HEADERS, RATE_LIMITS, REQUEST_LIMITS, CORS_CONFIG }
[7m   [0m [91m                                                        ~~~~~~~~~~~[0m
[96msrc/middleware/security.ts[0m:[93m318[0m:[93m41[0m - [91merror[0m[90m ts(2552): [0mCannot find name 'REQUEST_LIMITS'. Did you mean 'RequestInit'?

