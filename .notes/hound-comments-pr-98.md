# Hound comments â€” PR #98 (actionable checklist)

This single checklist groups hound review comments by file and gives minimal, behavior-preserving actions.

> Notes:
> - This checklist was created from the Hound comments sampled during the interactive session. If more hound comments exist in the PR, we should fetch PR #98's review comments (paginated) and append them here.
> - Each checklist item is written as a small, safe code change. If an item might touch runtime behavior, it's marked "review required".

---

## src/lib/state/enhanced-persistence.ts
- [x] Guard synchronous Node `require('crypto')` usage to avoid bundler/static analysis + lint rules. Action taken: added `tryRequireNode()` helper and used it for `randomBytes` fallback.

## src/lib/security/backup/recovery-testing.ts
- [x] Replace inline `require('crypto')` in fallback UUID generation with guarded runtime require helper. Action taken: added `tryRequireNode()` helper and used it.

## src/utils/offline/offlineManager.ts
- [ ] Replace `Map<string, Set<Function>>` and `listener: Function` with explicit function types or `(...args: unknown[]) => void` to satisfy `no-unsafe-function-type` and improve typing.
  - Proposed change (minimal): change `Map<string, Set<Function>>` -> `Map<string, Set<(payload?: unknown) => void>>` and `on(..., listener: Function)` -> `listener: (payload?: unknown) => void`.

## src/lib/utils.ts
- [ ] Replace `require('crypto')` top-level guarded usage with `tryRequireNode()` helper (or convert to ESM `import { randomBytes } from 'crypto'` where used only in node code). If `crypto` usage must be synchronous in server-only code, use the `tryRequireNode()` pattern used above.

## src/tests/cross-browser-compatibility.test.ts
- [x] Convert runtime `require('node:crypto')` / `require('node:path')` to top-level ESM imports in tests. (Batch 2 applied.)

## src/lib/config/performance-config.ts
- [ ] Remove `require('crypto')` patterns where top-level `import` is safe. If the code runs in both browser and Node, guard it using `tryRequireNode()`.

## Misc - multiple files (mechanical fixes)
- [ ] Replace explicit `any` types in a small subset of server-side modules with `unknown` or precise types. Examples flagged by linter: `src/pages/api/session/analytics.ts`, `src/pages/api/session/skills.ts`, `src/pages/api/bias-detection/export.ts`.
- [ ] Fix `preserve-caught-error` and unused caught error patterns by renaming unused caught error variables to `_err` or using `if (e instanceof Error) { ... }` where error properties are needed.
- [ ] Remove/clean invalid or unused `eslint-disable` directives reported by linter.

---

## How to use this checklist
- Work file-by-file in small commits. For each file:
  1. Apply the small change described.
  2. Run `pnpm lint` locally and ensure no new lint errors were introduced.
  3. Commit with message `fix(hound): <short-description> (PR #98)` and push to branch `fix/hound-comments-98`.

## Next steps
- [ ] Fetch full set of PR #98 review comments (paginated) and update this checklist with any missing items.
- [ ] Implement and push the remaining checked items in mechanical batches (rename unused params, guard requires, replace `any` -> `unknown`), re-run lint after each batch.

---

Generated by Copilot assistant during PR cleanup session.
