---

---

<button
  id="to-top-button"
  class="z-50 fixed right-5 bottom-6
    w-10 h-10 rounded-full
    op-0 pointer-events-none op-transition
    lt-lgp:(op-60! bg-#8883 dark:bg-#8886 pointer-events-auto!)
    hover:(op-100! bg-#8883) print:hidden"
  aria-label="Scroll to top"
  title="Scroll to top"
  tabindex="-1"
  aria-hidden="true"
>
  <div u-i-ri-arrow-up-line></div>
</button>

<script>
  // Handle visibility and accessibility logic
  const handleScroll = () => {
    const scrollThreshold = 300
    const toTopButton = document.getElementById('to-top-button')
    if (!toTopButton) return

    const handleClick = () => {
      window.scrollTo({ top: 0 });
    };

    const handleScroll = () => {
      const scrollThreshold = 300;
      const isDesktop = window.matchMedia("(min-width: 1024px)").matches;

      if (isDesktop) {
        // Desktop: show/hide based on scroll position
        const scrollY = window.scrollY || document.documentElement.scrollTop;
        if (scrollY <= scrollThreshold) {
          toTopButton.style.opacity = "0";
          toTopButton.style.pointerEvents = "none";
          toTopButton.setAttribute("tabindex", "-1");
          toTopButton.setAttribute("aria-hidden", "true");
          toTopButton.setAttribute("disabled", "");
        } else {
          toTopButton.style.opacity = "0.6";
          toTopButton.style.pointerEvents = "auto";
          toTopButton.removeAttribute("tabindex");
          toTopButton.removeAttribute("aria-hidden");
          toTopButton.removeAttribute("disabled");
        }
      } else {
        // Visible state
        toTopButton.style.opacity = '0.3'
        toTopButton.style.pointerEvents = 'auto'
        toTopButton.setAttribute('tabindex', '0')
        toTopButton.setAttribute('aria-hidden', 'false')
      }
    } else {
      // On mobile, reset to CSS defaults (which are visible)
      // Remove inline styles so CSS classes take over
      toTopButton.style.opacity = ''
      toTopButton.style.pointerEvents = ''
      // Reset accessibility attributes to visible state
      toTopButton.setAttribute('tabindex', '0')
      toTopButton.setAttribute('aria-hidden', 'false')
    }
  }

  // Set up event listeners
  document.addEventListener('astro:page-load', () => {
    const toTopButton = document.getElementById('to-top-button')

    // Add click handler
    if (toTopButton) {
      toTopButton.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' })
      })
    }

    // Initialize state on load
    handleScroll()
  })

  // Listen for scroll and resize events globally
  // (These persist across View Transitions in SPA mode, which is fine)
  window.addEventListener('scroll', handleScroll, { passive: true })
  window.addEventListener('resize', handleScroll, { passive: true })
</script>
