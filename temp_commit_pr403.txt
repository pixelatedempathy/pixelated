Applying user permission validation and rate limiting in TrainingWebSocketServer from PR #403
