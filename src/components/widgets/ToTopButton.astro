---

---

<button
  id="to-top-button"
  class="z-50 fixed right-5 bottom-6
    w-10 h-10 rounded-full
    op-0 pointer-events-none op-transition
    lt-lgp:(op-50! bg-#8883 dark:bg-#8886 pointer-events-auto!)
    hover:(op-100! bg-#8883)
    focus-visible:(op-100! opacity-100 ring-2 ring-indigo-500 outline-none pointer-events-auto)
    print:hidden"
  title="Scroll to top"
  aria-label="Scroll to top"
  tabindex="-1"
  aria-hidden="true"
>
  <div u-i-ri-arrow-up-line></div>
</button>

<script>
  const updateButtonState = () => {
    const scrollThreshold = 300;
    const toTopButton = document.getElementById("to-top-button");
    if (!toTopButton) return;

    // Desktop logic: hidden by default, shown on scroll
    if (window.matchMedia("(min-width: 1024px)").matches) {
      const scrollY = window.scrollY || document.documentElement.scrollTop;
      if (scrollY <= scrollThreshold) {
        // Hidden state
        toTopButton.style.opacity = "0";
        toTopButton.style.pointerEvents = "none";
        toTopButton.setAttribute("tabindex", "-1");
        toTopButton.setAttribute("aria-hidden", "true");
      } else {
        // Visible state
        toTopButton.style.opacity = "0.3";
        toTopButton.style.pointerEvents = "auto";
        toTopButton.removeAttribute("tabindex");
        toTopButton.removeAttribute("aria-hidden");
      }
    } else {
      // Mobile state: always visible (handled by CSS lt-lgp class)
      // We must ensure accessibility attributes are correct for visibility
      toTopButton.removeAttribute("tabindex");
      toTopButton.removeAttribute("aria-hidden");

      // Clean up inline styles that might persist from desktop mode
      toTopButton.style.opacity = "";
      toTopButton.style.pointerEvents = "";
    }
  };

  // Handle scroll events
  window.addEventListener("scroll", updateButtonState, { passive: true });

  // Initialize on page load (Astro View Transitions compatible)
  document.addEventListener("astro:page-load", () => {
    const toTopButton = document.getElementById("to-top-button");
    if (toTopButton) {
      toTopButton.addEventListener("click", () => {
        window.scrollTo({ top: 0, behavior: "smooth" });
      });
      // Initial state check
      updateButtonState();
    }
  });
</script>
